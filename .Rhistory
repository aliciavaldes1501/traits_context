show_col(hue_pal()(3))
show_col(hue_pal()(2))
show_col(hue_pal()(5))
show_col(hue_pal()(10))
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,
aes(color = population,fill=population))+ylab(NULL)+
geom_point(size = 0.5,aes(color=population))+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values = c("#F8766D", "#39B600", "#C77CFF"))+
scale_fill_manual(values = c("#F8766D", "#39B600", "#C77CFF"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
p8
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,
aes(color = population,fill=population))+ylab(NULL)+
geom_point(size = 0.5,aes(color=population))+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values = c("#F8766D", "#39B600", "#D89000"))+
scale_fill_manual(values = c("#F8766D", "#39B600", "#D89000"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
p8
show_col(hue_pal()(4))
show_col(hue_pal()(5))
show_col(hue_pal()(15))
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,
aes(color = population,fill=population))+ylab(NULL)+
geom_point(size = 0.5,aes(color=population))+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values = c("#F8766D", "#39B600", "#FD61D1"))+
scale_fill_manual(values = c("#F8766D", "#39B600", "#FD61D1"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
p8
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,
aes(color = population,fill=population))+ylab(NULL)+
geom_point(size = 0.5,aes(color=population))+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
p8
p7<-ggplot(data3, aes(meanT,phen_index1))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,color="blue",fill="lightblue")+ylab(NULL)+
geom_point(size = 0.5,color="blue")+ theme_base()+ xlab(NULL)+ylab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_x_continuous(limits = c(14,19))
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,
aes(color = population,fill=population))+ylab(NULL)+
geom_point(size = 0.5,aes(color=population))+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
pdf("./results/figures/fig2_phen_height_color.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
dev.off()
pdf("./results/figures/fig2_phen_height_color.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_gradient(low="yellow",high="red")
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_brewer(palette="YlGnBu")
p8
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_colour_manual(c(#4575b4,#91bfdb,#e0f3f8,#ffffbf,#fee090,#fc8d59,#d73027))
p9
pdf("./results/figures/fig2_phen_height.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
pdf("./results/figures/fig2_phen_height_color.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_colour_manual(c(#4575b4,#91bfdb,#e0f3f8,#ffffbf,#fee090,#fc8d59,#d73027))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_colour_manual(values=c("#4575b4","#91bfdb","#e0f3f8","#ffffbf","#fee090","#fc8d59","#d73027"))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_colour_manual(values=c("#4575b4","#91bfdb","#e0f3f8","#ffffbf","#fee090","#fc8d59","#d73027"
p9
pdf("./results/figures/fig2_phen_height.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
pdf("./results/figures/fig2_phen_height_color.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#4575b4","#91bfdb","#e0f3f8","#ffffbf","#fee090","#fc8d59","#d73027"))
p9
p9
p8
dev.off()
dev.off()
dev.off()
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_brewer(palette="YlOrRd")
p9
show_col(hue_pal()(3))
show_col(hue_pal()(20))
show_col(hue_pal()(100))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF00","#91bfdb","#e0f3f8","#ffffbf","#fee090","#fc8d59","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#0066CC","#91bfdb","#e0f3f8","#ffffbf","#fee090","#fc8d59","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF00","#91bfdb","#e0f3f8","#ffffbf","#fee090","#fc8d59","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF00","#FFCC33","#e0f3f8","#ffffbf","#fee090","#fc8d59","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#3399FF","#FFCC33","#e0f3f8","#FFFF00","#FFCC33","#fc8d59","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#003366","#3399FF","#e0f3f8","#FFFF00","#FFCC33","#fc8d59","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#003366","#3399FF","#abdda4","#FFFF00","#FFCC33","#fc8d59","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#003366","#3399FF","#abdda4","#FFFF00","#FFCC33","#FF3300","#d73027"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#003366","#3399FF","#abdda4","#FFFF00","#FFCC33","#FF6600","#CC0000"))
p9
pdf("./results/figures/figS2_ants_color.pdf", width=4,height=4)
pdf("./results/figures/figS2_ants_color.pdf", width=4,height=4)
p9
dev.off()
dev.off()
dev.off()
dev.off()
pdf("./results/figures/figS2_ants_color.pdf", width=4,height=4)
p9
dev.off()
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF00","#3399FF","#FFCC33","#FFFF00","#FF6600","#FF6600","#CC0000"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF66","#FFCC66","#FFCC33","#FFFF00","#FF6600","#FF6600","#CC0000"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF66","#FFFF00","#FFCC33","#FFFF00","#FF6600","#FF6600","#CC0000"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF00","#FFCC33","#FF9900","#FF6600","#CC0000","#FF6600","#CC0000"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF00","#FFCC33","#FF9900","#FF6600","#CC0000","#CC3333","#990033"))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF66","#FFFF00","#FFCC33","#FF9900","#FF6600","#CC0000","#CC3333"))
p9
pdf("./results/figures/fig2_phen_height.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
pdf("./results/figures/fig2_phen_height_color.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
pdf("./results/figures/figS2_ants_color.pdf", width=4,height=4)
p9
dev.off()
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF66","#FFFF00","#FFCC33","#FF9900","#FF6600","#FF0000","#CC3333"))
p9
pdf("./results/figures/figS2_ants_color.pdf", width=4,height=4)
p9
dev.off()
pdf("./results/figures/fig3_fruitset_color.pdf", width=3,height=3)
ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 0.5,color="blue")+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,,color="blue",fill="lightblue")+
theme_base()+xlab("Number of eggs")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
dev.off()
pdf("./results/figures/fig_appendix_temp_color.pdf", width=7,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="blue",fill="lightblue")+ylab("Soil temperature")+
geom_point(size = 0.5,color="blue")+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig_appendix_temp_together_color.pdf", width=3,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="blue",fillcolor="lightblue")+ylab("Soil temperature")+
geom_point(size = 0.5,color="blue")+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="blue",fillcolor="lightblue")+ylab("Soil temperature")+
geom_point(size = 0.5,color="blue")+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig_appendix_temp_together_color.pdf", width=3,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="blue",fill="lightblue")+ylab("Soil temperature")+
geom_point(size = 0.5,color="blue")+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# # # # # # # # # #  Final analyses to be included in paper # # # # # # # # #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
library(car)
library(grid)
library(cowplot)
models_fruitset_noT<-dredge(model_fruitset_noT)
summary(model.avg(models_fruitset_noT,subset=delta<2))
summary(model.avg(models_fruitset_extra,subset=delta<2))
summary(model.avg(models_fruitset,subset=delta<2))
