summary(model.avg(modelsCbis, subset = delta < 2))
modelsCbis[1]
summary(hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)
,data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail"))
rm(mdoelC)
rm(modelCbis)
model_eggs<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*pop,data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
models_eggs<-dredge(model_eggs)
summary(model.avg(models_eggs, subset = delta < 2))
model_eggs_best<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_best)
mnull<-hurdle(n_eggs_max~1,data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
nullmodel_eggs<-hurdle(n_eggs_max~1,data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
2*logLik(model_eggs)     # Deviance model_eggs
rm(mnull)
nullmodel_eggs<-hurdle(n_eggs_max~1,data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
2*logLik(model_eggs)     # Deviance model_eggs
2*logLik(nullmodel_eggs)  # Deviance null model
(-1459.397-(-1402.661))/-1459.397 # Only 2.7% !?
(-1459.397-(-1419.88))/-1459.397 # Only 2.7% !?
model_eggs_best<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_best)
nullmodel_eggs<-hurdle(n_eggs_max~1,data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
2*logLik(model_eggs)     # Deviance model_eggs
2*logLik(nullmodel_eggs)  # Deviance null model
(-1459.397-(-1402.661))/-1459.397 # Only 3.8% !?
model_eggs_H<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="H"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_R<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data8,pop=="R"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data8,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_H<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="H"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_R<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="R"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_H)
summary(model_eggs_R)
summary(model_eggs_T)
summary(model.avg(models_eggs, subset = delta < 2))
print.xtable(xtable(model_eggs_best,digits=c(0,3,3,2,3)),type="html",file="./results/tables/model_eggs_best.html")
summary(model_eggs_best)
2*logLik(model_eggs)     # Deviance model_eggs
2*logLik(nullmodel_eggs)  # Deviance null model
(-1459.397-(-1402.661))/-1459.397 # Only 3.8% !?
#. Percent deviance explained, defined as [D(null model) - D(fitted model)] / D(null model)
2*logLik(model_eggs)     # Deviance model_eggs
2*logLik(nullmodel_eggs)  # Deviance null model
(-1459.397-(-1402.661))/-1459.397 # Only 3.8% !?
install.packages("brms")
library(brms)
fit <- brm(meanT ~ scale(veg_h_mean)*pop, data = data3, family = "gaussian")
summary(fit, waic = TRUE)
fit <- brm(meanT ~ scale(veg_h_mean)*pop, data = data3, family = "gaussian")
fit <- brm(meanT ~veg_h_mean*pop, data = data3, family = "gaussian")
fit <- brm(meanT ~veg_h_mean, data = data3, family = "gaussian")
?brm
library("rstan") # observe startup messages
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
fit <- brm(meanT ~ scale(veg_h_mean)*pop, data = data3, family = "gaussian")
Sys.getenv("PATH")
library(brms)
fit <- brm(meanT ~ scale(veg_h_mean)*pop, data = data3, family = "gaussian")
Sys.getenv("PATH")
library(brms)
fit <- brm(meanT ~ scale(veg_h_mean)*pop, data = data3, family = "gaussian")
summary(fit, waic = TRUE)
fit <-brm(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*pop,data=data3,family="hurdle_negbinomial")
summary(fit, waic = TRUE)
fit <-brm(n_eggs_max~(scale(phen_index_avg)+scale(over_veg))*pop,data=data3,family="hurdle_negbinomial")
summary(fit, waic = TRUE)
rm(fit)
remove.packages("brms", lib="~/R/win-library/3.3")
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(xtable)
library(ggthemr)
library(fmsb)
library(ggthemes)
model_temp<-lm(meanT~scale(veg_h_mean)*pop,data=data3,na.action="na.fail")
summary(model_eggs_best)
a
model_eggs_H<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="H"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_R<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="R"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_H)
summary(model_eggs_R)
summary(model_eggs_T)
model_seggs_H<-dredge(model_eggs_H)
model_seggs_R<-dredge(model_eggs_R)
model_seggs_T<-dredge(model_eggs_T)
model_eggs_H<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="H"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_R<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="R"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_H)
summary(model_eggs_R)
summary(model_eggs_T)
models_seggs_H<-dredge(model_eggs_H)
models_seggs_R<-dredge(model_eggs_R)
models_seggs_T<-dredge(model_eggs_T)
summary(model.avg(models_seggs_H, subset = delta < 2))
summary(model.avg(models_seggs_R, subset = delta < 2))
summary(model.avg(models_seggs_T, subset = delta < 2))
rm(models_seggs_H)
rm(models_seggs_R)
models_eggs_H<-dredge(model_eggs_H)
models_eggs_R<-dredge(model_eggs_R)
models_eggs_T<-dredge(model_eggs_T)
summary(model.avg(models_eggs_H, subset = delta < 2))
summary(model.avg(models_eggs_R, subset = delta < 2))
summary(model.avg(models_eggs_T, subset = delta < 2))
summary(model_eggs_H)
with(data=subset(data3,pop=="H"),hist(n_eggs_max))
with(data=subset(data3,pop=="H"),hist(n_eggs_max,breaks=30))
with(data=subset(data3,pop=="R"),hist(n_eggs_max,breaks=30))
with(data=subset(data3,pop=="T"),hist(n_eggs_max,breaks=30))
summary(model_eggs_H)
summary(model_eggs_R)
summary(model_eggs_T)
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_T)
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_T)
summary(model_eggs_best)
models_eggs[1]
plot(effect(term="phen_index_avg", mod=model_eggs_best),multiline=T,type="response")
plot(effect(term="scale(phen_index_avg)", mod=model_eggs_best),multiline=T,type="response")
effect(term="scale(phen_index_avg)", mod=model_eggs_best)
visreg(model_eggs_best)
ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max,colour=pop)) +
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)
ggplot(data3, aes(over_veg,ifelse(as.integer(data8$attack)==2,1,0),colour=pop)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)
ggplot(data3, aes(over_veg,ifelse(as.integer(data3$attack)==2,1,0),colour=pop)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)
data3$attack
data3$attack<-with(data3,ifelse(n_eggs_max>0,1,0))
data3$attack
ggplot(data3, aes(over_veg,ifelse(as.integer(data3$attack)==2,1,0),colour=pop)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)
str(data3)
ggplot(data3, aes(over_veg,as.integer(data3$attack),colour=pop)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggthemr(palette="greyscale", layout = "clean")
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height"
)
ggthemr_reset()
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")
ggplot(data3, aes(phen_index_avg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~pop)+
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~pop)+
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig4_eggs.pdf", family="Times")
p9<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")+
theme(plot.background=element_rect(fill="white", colour=NA))
p10<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~pop)+
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))
multiplot(p7,p8,cols=1)
dev.off()
dev.off()
dev.off()
p9<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")+
theme(plot.background=element_rect(fill="white", colour=NA))
p10<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~pop)+
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p7,p8,cols=1)
dev.off()
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Phenology")+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
ggthemr_reset()
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Phenology")+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
library(ggthemes)
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Phenology")+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")+
theme(plot.background=element_rect(fill="white", colour=NA))
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")+
theme(plot.background=element_rect(fill="white", colour=NA))
p10<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~pop)+
geom_smooth(method = "glm.nb", se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=5)
multiplot(p9,p10,cols=1)
dev.off()
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=5.5)
multiplot(p9,p10,cols=1)
dev.off()
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
p10<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~pop)+
geom_smooth(method = "glm.nb", se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
data3$fruit_set<-data3$n_intact_fruits/data3$n_fl
with(data10,boxplot(fruit_set))
with(data3,boxplot(fruit_set))
with(data3,hist(fruit_set))
with(data3,plot(fruit_set))
with(data3,plot(pop,fruit_set))
with(data3,mean(fruit_set))
with(subset(data3,pop=="R"),mean(fruit_set))
with(subset(data3,pop=="R"),fruit_set)
rm(model_seggs_H)
rm(model_seggs_R)
rm(model_seggs_T)
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data3,na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=subset(data3,pop=="H"|pop="T"),na.action="na.fail")
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=subset(data3,pop=="H"|pop=="T"),na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=data3,na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
with(subset(data3,pop=="R"),fruit_set)
with(subset(data3,pop=="R"),nobs(fruit_set>0))
with(subset(data3,pop=="R"),n(fruit_set>0))
with(subset(data3,pop=="R"),(fruit_set>0))
p11<-
ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
p11<-
ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))+theme_base()+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+ylab("Number of intact fruits / Number of flowers")+
theme(plot.background=element_rect(fill="white", colour=NA))
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=data3,na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab("Number of intact fruits / Number of flowers")+
theme(plot.background=element_rect(fill="white", colour=NA))
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+ylab("Number of intact fruits / Number of flowers")+
theme(plot.background=element_rect(fill="white", colour=NA))
p11<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab("Number of intact fruits / Number of flowers")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=6)
multiplot(p11,p12,cols=1)
dev.off()
dev.off()
dev.off()
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=6)
multiplot(p11,p12,cols=1)
dev.off()
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+ylab("Number of intact fruits / Number of flowers")+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab("Number of intact fruits / Number of flowers")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=6)
multiplot(p11,p12,cols=1)
dev.off()
?multiplot
ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+
ylab(expression(atop("Number of intact fruits /", paste("Number of flowers"))))+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+
ylab(expression(atop("Number of intact fruits /", paste("Number of flowers"))))+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+
ylab(expression(atop("Number of intact fruits /", paste("Number of flowers"))))+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=6)
multiplot(p11,p12,cols=1)
dev.off()
dev.off()
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+
ylab(expression(atop("Number of intact fruits /", paste("Number of flowers"))))+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+
ylab(expression(atop("Number of intact fruits /", paste("Number of flowers"))))+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=6)
multiplot(p11,p12,cols=1)
dev.off()
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
multiplot(p11,p12,cols=1)
dev.off()
library(gridExtra)
grid.arrange(p11, p12)
?grid.arrange
grid.arrange(p11, p12.left="blau")
grid.arrange(p11, p12,left="blau")
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+
ylab(expression(atop("Number of intact fruits /", paste("Number of flowers"))))+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+
ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
grid.arrange(p11, p12,left="Number of intact fruits / Number of flowers")
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers",
gp=gpar(fontsize=24))
)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers",
gp=gpar(fontsize=12))
)
)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers",
gp=gpar(fontsize=12)))
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,
gp=gpar(fontsize=14)))
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,
gp=gpar(fontsize=16)))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,gp=gpar(fontsize=16)))
dev.off()
dev.off()
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,gp=gpar(fontsize=16)))
dev.off()
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,gp=gpar(fontsize=16)))
dev.off()
p9<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~population)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Difference betwen shoot and vegetation height")+
theme(plot.background=element_rect(fill="white", colour=NA))
p10<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~population)+
geom_smooth(method = "glm.nb", se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
print.xtable(xtable(xtable(summary(model.avg(models_fruitset, subset = delta < 2))),
digits=c(0,3,3,3,2,3)), type="html",file="./results/tables/model_fruitset.html")
models_fruitset[1]
summary(glm(cbind(n_intact_fruits,n_fl)~scale(phen_index_avg)+scale(n_eggs_max)*pop+scale(over_veg),
family="binomial",data=data3,na.action="na.fail"))
summary(model_ants_best)
model_fruitset_best<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index_avg)+scale(n_eggs_max)*pop+scale(over_veg),
family="binomial",data=data3)
summary(model_fruitset_best)
r.squaredLR(model_fruitset_best)
NagelkerkeR2(model_fruitset_best)
