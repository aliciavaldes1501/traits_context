cortable
lower.tri(cortable, diag = FALSE)
cortable<-round(cor(data1corr,use="pairwise.complete.obs" ),2)
cortable[lower.tri(cortable)]<-""
cortable<-as.data.frame(cortable)
cortable
cortable<-round(cor(data1corr,use="pairwise.complete.obs" ),2)
cortable[upper.tri(cortable)]<-""
cortable<-as.data.frame(cortable)
cortable
print(xtable(cortable), type="html")
print(xtable(cortable), type="html")
for (i in 3:ncol(data1)){boxplot(as.numeric(data1[,i]),main=paste(colnames(data1)[i]))}
for (i in 3:ncol(data1)){hist(as.numeric(data1[,i]),main=paste(colnames(data1)[i]))}
par(mfrow=c(1,3),
oma = c(5,4,1,1) + 0.1,
mar = c(3,3,2,2) + 0.1)
for (i in c(3:9,16:18,21:27,31:39)){plot(data1$population,data1[,i],main=paste(colnames(data1)[i]))}
for (i in 3:9){print(summary(aov(as.numeric(data1[,i])~data1$population)))}
for (i in 16:ncol(data1)){print(summary(aov(as.numeric(data1[,i])~data1$population)))}
for (i in 3:9){print(TukeyHSD(aov(as.numeric(data1[,i])~population)))}
for (i in 16:ncol(data1)){print(TukeyHSD(aov(as.numeric(data1[,i])~population)))}
for (i in c(3:9,16:18,21:27,31:39)){plot(data1$population,data1[,i],main=paste(colnames(data1)[i]))}
pdf("./results/figures/diffs_pops_data1.pdf", family="Times")
for (i in c(3:9,16:18,21:27,31:39)){plot(data1$population,data1[,i],main=paste(colnames(data1)[i]))}
dev.off()
cor(data1[c(3:4,7:9,17:18,25,27,31,39)],use="pairwise.complete.obs")
library(lme4)
library(sciplot)
library(RVAideMemoire)
library(lmerTest)
install.packages("ade4")
install.packages("acepack")
install.packages("ggplot2")
install.packages(c("colorspace", "corrgram", "effects", "gamlss", "git2r", "hms", "htmlwidgets", "installr"))
install.packages(c("irlba", "jsonlite", "kernlab", "knitr", "lavaan", "mgcv", "miscTools", "mixOmics", "mnormt"))
install.packages(c("openssl", "permute", "proto", "psych", "qgraph", "quantmod", "R6", "Rcmdr", "rcompanion", "Rcpp", "reshape2", "rgdal"))
install.packages(c("qgraph", "rmarkdown", "Rmpfr", "RVAideMemoire", "shiny", "sjmisc", "sjPlot", "sjstats", "SparseM", "statmod", "stringdist", "stringi", "vcd", "vegan", "visNetwork", "XML", "yaml"))
install.packages("qgraph")
install.packages("qgraph")
library(lme4)
library(sciplot)
library(RVAideMemoire)
library(lmerTest)
dataseeds1<-read.table("./data/clean/seeds_up_p_means.txt",header=T,sep="\t",dec=",")
head(dataseeds1)
tail(dataseeds1)
str(dataseeds1)
hist(dataseeds1$n_dev)
hist(log(dataseeds1$n_dev)+1)
hist(dataseeds1$perc_dev)
hist(dataseeds1$mean_w_dev_mcg)
mod1<-glmer(round(n_dev)~p_up+(1|pl_id),family="poisson",data=dataseeds1)
summary(mod1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="Number of developed seeds",type="p",bty="l",legend=F))
overdisp.glmer(mod1) #There is overdispersion
dataseeds1$id<-1:60
mod1<-glmer(round(n_dev)~p_up+(1|pl_id)+(1|id),family="poisson",data=dataseeds1)
summary(mod1)
overdisp.glmer(mod1) #There is not overdispersion! - Model OK
pdf("./results/figures/diff_nseeds_p_up.pdf", family="Times")
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="Number of developed seeds",type="p",bty="l",legend=F))
dev.off()
dataseeds1$prop_dev<-cbind(round(dataseeds1$n_dev),round(dataseeds1$n_total))
mod2<-glmer(prop_dev~p_up+(1|pl_id),family="binomial",data=dataseeds1)
summary(mod2)
pdf("./results/figures/diff_percseeds_p_up.pdf", family="Times")
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="Percentage of developed seeds from total",type="p",bty="l",legend=F))
dev.off()
overdisp.glmer(mod2) #There is overdispersion
mod2<-glmer(prop_dev~p_up+(1|pl_id)+(1|id),family="binomial",data=dataseeds1)
summary(mod2)
overdisp.glmer(mod2) #There is not overdispersion! - Model OK
mod3<-lmer(mean_w_dev_mcg~p_up+(1|pl_id),data=dataseeds1)
summary(mod3)
pdf("./results/figures/diff_seedweight_p_up.pdf", family="Times")
dev.off()
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Mean seed weight for developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
pdf("./results/figures/diff_seedweight_p_up.pdf", family="Times")
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Mean seed weight for developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="N developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="% developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Weight developed seeds (µg)",type="p",bty="l",legend=F))
pdf("./results/figures/seeds_p_up.pdf", family="Times")
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="N developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="% developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Weight developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
?pdf
pdf("./results/figures/seeds_p_up.pdf", family="Times",width=7,height=3)
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="N developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="% developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Weight developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
par(mfrow=c(1,1),cex.lab=1)
with(subset(dataseeds1,!is.na(n_dev)),interaction.plot(ripe_when_collect,p_up,n_dev,type="b",
ylim=c(100,600),col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds1,!is.na(perc_dev)),interaction.plot(ripe_when_collect,p_up,perc_dev,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds1,!is.na(mean_w_dev_mcg)),interaction.plot(ripe_when_collect,p_up,mean_w_dev_mcg,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
dataseeds2<-read.table("./data/clean/seeds_means.txt",header=T,sep="\t",dec=",")
head(dataseeds2)
tail(dataseeds2)
str(dataseeds2)
dataseeds2$prop_dev<-cbind(round(dataseeds2$n_dev),round(dataseeds2$n_total))
hist(dataseeds2$n_dev)
hist(dataseeds2$perc_dev)
hist(dataseeds2$mean_w_dev_mcg)
mod3<-glmer(round(n_dev)~population2+(1|pl_id),family="poisson",data=dataseeds2)
summary(mod3)
overdisp.glmer(mod3)
dataseeds2$id<-1:179
mod3<-glmer(round(n_dev)~population2+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod3)
overdisp.glmer(mod3)
mod4<-glmer(prop_dev~population2+(1|pl_id),family="binomial",data=dataseeds2)
summary(mod4)
overdisp.glmer(mod4)
mod4<-glmer(prop_dev~population2+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod4)
overdisp.glmer(mod4)
mod5<-lmer(mean_w_dev_mcg~population2+(1|pl_id),data=dataseeds2)
summary(mod5)
with(dataseeds2,lineplot.CI(population2,n_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=F))
pdf("./results/figures/seeds_pops.pdf", family="Times",width=7,height=3)
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds2,lineplot.CI(population2,n_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,perc_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Percentage of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,mean_w_dev_mcg,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Weight developed seeds (µg)",type="p",cex=2,bty="l",legend=F))
dev.off()
pdf("./results/figures/seeds_pops.pdf", family="Times",width=9,height=3)
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds2,lineplot.CI(population2,n_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,perc_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Percentage of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,mean_w_dev_mcg,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Weight developed seeds (µg)",type="p",cex=2,bty="l",legend=F))
dev.off()
mod6<-glmer(round(n_dev)~ripe_when_collect+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod6)
overdisp.glmer(mod6)
mod7<-glmer(prop_dev~ripe_when_collect+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod7)
overdisp.glmer(mod7)
mod8<-lmer(mean_w_dev_mcg~ripe_when_collect+(1|pl_id),data=dataseeds2)
summary(mod8)
with(dataseeds2,lineplot.CI(ripe_when_collect,n_dev,group=population2,
xlab="",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=T))
?lineplot.CI
with(dataseeds2,lineplot.CI(ripe_when_collect,n_dev,group=population2,
xlab="",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=T))
with(dataseeds2,lineplot.CI(ripe_when_collect,perc_dev,group=population2,
xlab="",ylab="Percentage of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(ripe_when_collect,mean_w_dev_mcg,group=population2,
xlab="",ylab="Weight developed seeds (µg)",type="p",cex=2,bty="l",legend=F))
mod9<-glmer(round(n_dev)~ripe_when_collect*population2+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod9)
Anova(mod9,type="II")
mod10<-glmer(prop_dev~ripe_when_collect*population2+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod10)
Anova(mod10,type="II")
mod11<-lmer(mean_w_dev_mcg~ripe_when_collect*population2+(1|pl_id),data=dataseeds2)
summary(mod11)
Anova(mod11,type="II")
with(subset(dataseeds2,!is.na(n_dev)),interaction.plot(ripe_when_collect,population2,n_dev,type="b",
ylim=c(100,600),col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(perc_dev)),interaction.plot(ripe_when_collect,population2,perc_dev,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(mean_w_dev_mcg)),interaction.plot(ripe_when_collect,population2,mean_w_dev_mcg,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
mod12<-glmer(round(n_dev)~ripe_when_collect*p_up+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod12)
Anova(mod12,type="II")
mod13<-glmer(prop_dev~ripe_when_collect*p_up+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod13)
Anova(mod13,type="II")
mod14<-lmer(mean_w_dev_mcg~ripe_when_collect*p_up+(1|pl_id),data=dataseeds2)
summary(mod14)
library(car)
summary(mod13)
Anova(mod13,type="II")
mod14<-lmer(mean_w_dev_mcg~ripe_when_collect*p_up+(1|pl_id),data=dataseeds2)
summary(mod14)
Anova(mod14,type="II")
with(subset(dataseeds2,!is.na(n_dev)),interaction.plot(ripe_when_collect,p_up,n_dev,type="b",
ylim=c(100,600),col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(perc_dev)),interaction.plot(ripe_when_collect,p_up,perc_dev,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(mean_w_dev_mcg)),interaction.plot(ripe_when_collect,p_up,mean_w_dev_mcg,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
?interaction.plot
head(dataseeds2)
library(plyr)
loggers<-read.table(".data/clean/raw_data_loggers.txt",header=T,sep="\t",dec=".")
loggers<-read.table("./data/clean/raw_data_loggers.txt",header=T,sep="\t",dec=".")
head(loggers)
str(loggers)
loggers$date<-as.Date(loggers$date,format="%m/%d/%Y")
head(loggers)
loggers<-subset(loggers,date<"2015-09-01")
loggers$timeday<-ifelse(loggers$hour==1|loggers$hour==4|loggers$hour==22,yes="night",no="day")
head(loggers)
loggers_day<-subset(loggers,timeday=="day")
loggers_day_agg<-ddply(loggers_day,c("pop", "id_pl","date"), summarise,
meanT = mean(LogData),
maxT = max(LogData),
minT = min(LogData),
sdT  = sd(LogData))
?dply
?ddply
loggers_day_agg$rangeT<-loggers_day_agg$maxT-loggers_day_agg$minT
head(loggers_day_agg)
loggers_day_agg<-aggregate(cbind(meanT, maxT, minT, sdT, rangeT) ~ pop + id_pl, data=loggers_day_agg, FUN=mean)
head(loggers_day_agg)
str(loggers_day_agg)
cor(loggers_day_agg[3:7])
library(ggplot2)
library(MASS)
library(MuMIn)
sessionInfo()
names(data1comp)
names(data1)
data1<-data1[c(1:2,4,7,17:18,23,28:30)]
head(data1)
str(data1)
data3<-merge(data1,loggers_day_agg,by="id_pl")
write.table(data3,file="./data/clean/datafile3.txt",sep="\t",dec=".",col.names=T)
library(visreg)
library(effects)
library(pscl)
library(lme4)
head(data3)
with(data3,table(pop))#104,94,103
str(data3)#301 obs
names(data3)
data3$phen_index<-NULL
data3$most_adv<-NULL
data3$n_fl_corrected<-NULL
data3$t_phen_index<-NULL
data3$t_most_adv
data3$predicted
names(data3)
phen_revised<-read.table("./data/clean/data_phen_revised.txt",header=T,sep="\t",dec=".")
head(phen_revised)
str(phen_revised) #302 obs
with(phen_revised,table(pop))#102,97,103
data3<-merge(data3,phen_revised,by="id_pl")
head(data3)
str(data3) #295 obs
with(data3,table(pop))#99,93,103
data3<-subset(data3,veg_h_mean<90)
str(data3) #295 obs
with(data3,table(pop))#99,95,103
write.table(data3,file="./data/clean/datafile3.txt",sep="\t",dec=".",col.names=T)
with(data3,hist(phen_index1))
with(data3,hist(phen_index2))
with(data3,hist(most_adv1))
with(data3,hist(most_adv2))
with(data3,hist(n_fl))
data3$phen_index_diff<-data3$phen_index2-data3$phen_index1
model1<-lm(phen_index2~phen_index1*n_fl,data=subset(data3,phen_index_diff>0))
summary(model1) #R2=0.44
nobs(model1) #295-23=272 plants
plot(model1) #meh
with(subset(data5,phen_index_diff>0),plot(phen_index2~phen_index1))
with(subset(data3,phen_index_diff>0),plot(phen_index2~phen_index1))
with(subset(data3,phen_index_diff>0),plot(phen_index2~n_fl))
newdata<-subset(data3,phen_index_diff==0)[c(1,21,32)]
newdata$phen_index2_pred<-predict(model1,newdata)
newdata
data3<-merge(data3,newdata[c(1,4)],by="id_pl",all.x=T)
data3$phen_index2c<-ifelse(data3$phen_index_diff>0,data3$phen_index2,data3$phen_index2_pred)
with(data3,hist(phen_index2))
with(data3,hist(phen_index2c))
data3$phen_index_avg<-(data3$phen_index1+data3$phen_index2c)/2
with(data3,hist(phen_index_avg))
par(mfrow=c(1,3))
with(data5,hist(phen_index1,main="Mean on 29-30 July"))
with(data5,hist(phen_index2c,main="Mean on 27-29 August, corr"))
with(data3,hist(phen_index1,main="Mean on 29-30 July"))
with(data3,hist(phen_index2c,main="Mean on 27-29 August, corr"))
with(data3,hist(phen_index_avg,main="Mean, average 2 dates"))
p1<-ggplot(data3, aes(x=phen_index1, fill=pop)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 29-30 July")
p2<-ggplot(data3, aes(x=phen_index2c, fill=pop)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 27-29 August, corr")
p3<-ggplot(data3, aes(x=phen_index_avg, fill=pop)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean, average 2 dates")
library(ggplot2)
p1<-ggplot(data3, aes(x=phen_index1, fill=pop)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 29-30 July")
p2<-ggplot(data3, aes(x=phen_index2c, fill=pop)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 27-29 August, corr")
p3<-ggplot(data3, aes(x=phen_index_avg, fill=pop)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean, average 2 dates")
multiplot(p1, p2, p3, cols=3)
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
multiplot(p1, p2, p3, cols=3)
p1<-ggplot(data5, aes(x=phen_index1)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 29-30 July")
p2<-ggplot(data5, aes(x=phen_index2c)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 27-29 August, corr")
p1<-ggplot(data3, aes(x=phen_index1)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 29-30 July")
p2<-ggplot(data3, aes(x=phen_index2c)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 27-29 August, corr")
p3<-ggplot(data3, aes(x=phen_index_avg)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean, average 2 dates")
multiplot(p1, p2, p3, cols=3)
phenology<-read.table("phenology.txt",header=T,sep=",",dec=".",na.strings=".")
head(phenology)
phenology<-read.table("./data/clean/phenology.txt",header=T,sep=",",dec=".",na.strings=".")
head(phenology)
phenology<-read.table("./data/clean/phenology.txt",header=T,sep=",",dec=".",na.strings=".")
head(phenology)
str(phenology)
p1<-ggplot(phenology,aes(x=phen_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Average 2 dates")+theme(plot.title=element_text(size=10))
p2<-ggplot(phenology,aes(x=julian_w3))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Julian day when phen=3")+theme(plot.title=element_text(size=10))
p3<-ggplot(phenology,aes(x=julian_w2))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Julian day when phen=2")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=3)
head(phenology[c(1,9:10)])
head(phenology)
newdata
head(phenology)
phenology<-read.table("./data/clean/phenology.txt",header=T,sep=",",dec=".",na.strings=".")
head(phenology)
str(phenology)
names(data3)
data3<-merge(data3,phenology[c(1,9)],by="id_pl")
head(data3)
str(data3)
p1<-ggplot(data3,aes(x=phen_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Average 2 dates")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=julian_w3))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Julian day when phen=3")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, cols=2)
head(data3)
p1<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Average 2 dates")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=julian_w3))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Julian day when phen=3")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, cols=2)
p1<-ggplot(data3, aes(x=phen_index1)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 29-30 July")
p2<-ggplot(data3, aes(x=phen_index2c)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean on 27-29 August, corr")
p3<-ggplot(data3, aes(x=phen_index_avg)) + geom_density(alpha=.3)+theme(legend.position="none")+ggtitle("Mean, average 2 dates")
multiplot(p1, p2, p3, cols=3)
#Phenology at time 1, 2, and average
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=2)
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=3)
p1<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Average 2 dates")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=julian_w3))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Julian day when phen=3")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, cols=2)
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=3)
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+ theme_classic()
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+ theme_classic()
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+ theme_classic()
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=3)
ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+ theme_bw()
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+ theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=3)
devtools::install_github('cttobin/ggthemr')
install.packages("curl")
devtools::install_github('cttobin/ggthemr')
ggthemr('greyscale')
library(ggthemr)
ggthemr('greyscale')
?ggthemr
ggthemr(paletter="greyscale", layout = "clear")
ggthemr(palette="greyscale", layout = "clear")
#Set the colour scheme and layout for ggplot (stays for whole session)
ggthemr(palette="greyscale", layout = "clear")
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=3)
ggthemr(palette="greyscale", layout = "clean")
ggthemr(palette="greyscale", layout = "clean")
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
multiplot(p1, p2, p3, cols=3)
multiplot(p1, p2, p3, cols=3)
#Phenology at time 1, 2, and average
p1<-ggplot(data3,aes(x=phen_index1))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 29-30 July")+theme(plot.title=element_text(size=10))
p2<-ggplot(data3,aes(x=phen_index2c))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean on 27-29 August, corr")+theme(plot.title=element_text(size=10))
p3<-ggplot(data3,aes(x=phen_index_avg))+
geom_histogram(aes(y=..density..),binwidth=.5,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Mean, average 2 dates")+theme(plot.title=element_text(size=10))
p4<-ggplot(data3,aes(x=julian_w3))+
geom_histogram(aes(y=..density..),binwidth=10,colour="black", fill="white")+
geom_density(alpha=.2, fill="#FF6666")+ggtitle("Julian day when phen=3")+theme(plot.title=element_text(size=10))
pdf("./results/figures/comparison_distr_phen_measures.pdf", family="Times")
multiplot(p1, p2, p3, p4, cols=2)
dev.off()
multiplot(p1, p2, p3, p4, cols=2)
