theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
print.xtable(xtable(xtable(summary(model.avg(models_fruitset, subset = delta < 2))),
digits=c(0,3,3,3,2,3)), type="html",file="./results/tables/model_fruitset.html")
models_fruitset[1]
summary(glm(cbind(n_intact_fruits,n_fl)~scale(phen_index_avg)+scale(n_eggs_max)*pop+scale(over_veg),
family="binomial",data=data3,na.action="na.fail"))
summary(model_ants_best)
model_fruitset_best<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index_avg)+scale(n_eggs_max)*pop+scale(over_veg),
family="binomial",data=data3)
summary(model_fruitset_best)
r.squaredLR(model_fruitset_best)
NagelkerkeR2(model_fruitset_best)
head(data1)
data_vegplots_2015<-read.table("./data/clean/datafile_vegplots_2015.txt",header=T,sep="\t",dec=".")
head(data_vegplots_2015)
names(data_vegplots_2015)
head(data1)
names(data_vegplots_2015)
data_vegplots_2015<-subset(data_vegplots_2015,treat=="Uncut")
head(data_vegplots_2015)
data_vegplots_2015<-data_vegplots_2015[c(3,5,8,18:19,24,29:31)]
head(data1)
head(data_vegplots_2015)
data_vegplots_2015$population<-"Högsjön"
head(data_vegplots_2015)
str(data_vegplots_2015)
str(data1)
data_vegplots_2015$population<-as.factor("Högsjön")
str(data_vegplots_2015)
data4<-merge(data1,data_vegplots_2015,by=="id_pl")
data_vegplots_2015$shoot_h<-as.numeric(data_vegplots_2015$shoot_h)
data_vegplots_2015$veg_h_mean<-as.numeric(data_vegplots_2015$veg_h_mean)
data_vegplots_2015$phen_index<-as.numeric(data_vegplots_2015$phen_index)
str(data_vegplots_2015)
data4<-merge(data1,data_vegplots_2015,by=="id_pl")
data4<-merge(data1,data_vegplots_2015,by="id_pl")
str(data4)
names(data1)
names(data_vegplots_2015)
data4<-rbind(data1,data_vegplots_2015)
str(data4)
str(data1)
data4$id_pl
head(data4)
tail(data4)
view(data4)
View(data4)
with(data1,hist(phen_index))
with(data4,hist(phen_index))
View(data4)
tail(data4)
?rbind
head(data_vegplots_2015)
data_vegplots_2015<-read.table("./data/clean/datafile_vegplots_2015.txt",header=T,sep="\t",dec=".")
head(data_vegplots_2015)
names(data_vegplots_2015)
data_vegplots_2015<-subset(data_vegplots_2015,treat=="Uncut")
head(data_vegplots_2015)
data_vegplots_2015<-data_vegplots_2015[c(3,5,8,18:19,24,29:31)]
data_vegplots_2015$population<-as.factor("Högsjön")
data_vegplots_2015$shoot_h<-as.numeric(data_vegplots_2015$shoot_h)
data_vegplots_2015$veg_h_mean<-as.numeric(data_vegplots_2015$veg_h_mean)
data_vegplots_2015$phen_index<-as.numeric(data_vegplots_2015$phen_index)
head(data_vegplots_2015)
data_vegplots_2015<-read.table("./data/clean/datafile_vegplots_2015.txt",header=T,sep="\t",dec=".")
names(data_vegplots_2015)
#leaving only needed variables
data_vegplots_2015<-subset(data_vegplots_2015,treat=="Uncut")
head(data_vegplots_2015)
data_vegplots_2015<-data_vegplots_2015[c(3,5,8,18:19,24,29:31)]
head(data_vegplots_2015)
data_vegplots_2015$population<-as.factor("Högsjön")
as.numeric(data_vegplots_2015$phen_index)
str(data_vegplots_2015)
data_vegplots_2015<-read.table("./data/clean/datafile_vegplots_2015.txt",header=T,sep="\t",dec=",")
names(data_vegplots_2015)
data_vegplots_2015<-subset(data_vegplots_2015,treat=="Uncut")
data_vegplots_2015<-data_vegplots_2015[c(3,5,8,18:19,24,29:31)]
head(data_vegplots_2015)
str(data_vegplots_2015)
data_vegplots_2015$population<-as.factor("Högsjön")
head(data_vegplots_2015)
str(data_vegplots_2015)
str(data1)
data4<-rbind(data1,data_vegplots_2015)
str(data4)
head(data4)
tail(data4)
with(data1,hist(phen_index))
with(data4,hist(phen_index))
with(data1,hist(veg_h_mean))
with(data1,hist(veg_h_mean))
with(data1,hist(phen_index))
with(data4,hist(phen_index))
with(data1,hist(veg_h_mean))
with(data4,hist(veg_h_mean))
with(data1,hist(most_adv))
with(data4,hist(most_adv))
with(data1,hist(n_intact_fruits))
with(data4,hist(n_intact_fruits))
with(data1,hist(n_fl_corrected))
with(data4,hist(n_fl_corrected))
with(data1,hist(n_eggs_max))
with(data4,hist(n_eggs_max))
with(data1,hist(n_redants))
with(data4,hist(n_redants))
with(data1,hist(n_redants,breaks=60))
with(data4,hist(n_redants,breaks=60))
head(phen_revised)
head(data_vegplots_2015)
str(data_vegplots_2015)
str(data4)
head(data4)
tail(data4)
head(data1)
head(data3)
names(data3)
head(data4)
names(data3)
head(data_vegplots_2015)
str(data4)
head(data4)
tail(data4)
phen_revised<-read.table("./data/clean/data_phen_revised.txt",header=T,sep="\t",dec=".")
phen_revised_cut_vegplots_2015<-read.table("./data/clean/data_phen_revised_cut_vegplots_2015.txt",header=T,sep="\t",dec=".")
phen_revised_cut_vegplots_2015<-read.table("./data/clean/data_phen_revised_cut_vegplots_2015.txt",header=T,sep="\t",dec=".")
data4$phen_index<-NULL
data4$most_adv<-NULL
data4$n_fl_corrected<-NULL
data4<-merge(data4,phen_revised,by="id_pl")
head(data4)
str(data4)
View(data4)
data4<-rbind(data1,data_vegplots_2015)
str(data4)
head(data4)
tail(data4)
phen_revised<-read.table("./data/clean/data_phen_revised.txt",header=T,sep="\t",dec=".")
phen_revised_cut_vegplots_2015<-read.table("./data/clean/data_phen_revised_cut_vegplots_2015.txt",header=T,sep="\t",dec=".")
data4$phen_index<-NULL
data4$most_adv<-NULL
data4$n_fl_corrected<-NULL
data4A<-merge(data4,phen_revised,by="id_pl")
head(data4A)
str(data4A)
with(data4A,table(pop))#99,95,103
with(data4A,table(population))#99,95,103
data4B<-merge(data4,phen_revised_cut_vegplots_2015,by="id_pl")
head(data4B)
str(data4B)
with(data4B,table(pop))#99,95,103
with(data4B,table(population))#99,95,103
head(data4A)
head(data4B)
data4A$julian1<-NULL
data4A$julian2<-NULL
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#50,0,0
data5<-subset(data5,veg_h_mean<90)
str(data5) #295 obs
with(data5,table(population))#99,93,103
head(data5)
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
str(subset(data5,phen_index_diff==0))
subset(data5,phen_index_diff==0)
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #295-23=272 plants
295-26
str(data5)
350-26
str(data5) #350 obs
str(subset(data5,phen_index_diff==0))
str(subset(data5,phen_index_diff>00))
str(subset(data5,phen_index_diff>0))
str(subset(data5,phen_index_diff<0))
nobs(model1rep) #350-26=272 plants
350-323
350-26
str(subset(data5,phen_index_diff=0))
str(subset(data5,phen_index_diff==0))
str(subset(data5,phen_index_diff>00))
323+26
str(subset(data5,phen_index_diff==NA))
data5$phen_index_diff
tail(data5)
nobs(model1rep) #350-26=272 plants
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
with(subset(data5,phen_index_diff>0),plot(phen_index2~phen_index1))
with(subset(data5,phen_index_diff>0),plot(phen_index2~n_fl))
names(data5)
newdata
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5<-merge(data5,newdata[c(1,4)],by="id_pl",all.x=T)
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
with(data5,hist(phen_index2))
with(data5,hist(phen_index2c))
data5$phen_index_avg<-(data5$phen_index1+data5$phen_index2c)/2
with(data5,hist(phen_index_avg))
data5$over_veg<-data5$shoot_h-data5$veg_h_mean
data5$over_veg<-data5$shoot_h-data5$veg_h_mean
model_eggs_rep<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*pop,data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
data5$over_veg<-data5$shoot_h-data5$veg_h_mean
model_eggs_rep<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*pop,data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_rep<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*population,data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
head(data5)
data5$phen_index_avg
data5$over_veg
data5$n_redants
View(data5)
subset(data5,phen_index_avg=NA)
subset(data5,phen_index_avg==NA)
subset(data5,phen_index_avg=="NA")
subset(data5,phen_index_avg="NA")
subset(data5,is.na(phen_index_avg))
newdatarep
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
subset(data5,is.na(phen_index_avg))
data5<-rbind(data4A,data4B)
with(data5,table(population))#152,97,103
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5<-merge(data5,newdata[c(1,4)],by="id_pl",all.x=T)
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
head(data5)
data5$phen_index2c
subset(data5,is.na(phen_index2c))
newdatarep
?merge
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#152,97,103
#Remove two outliers from Remmene where veg_h was >90 cm
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
#There were 26 plants where phenology did not change from t1 to t2
#Assign them a state at t2 based on what we would expect if development had continued
#Use the relationship: phen_index2 = phen_index1 + n_fl + phen_index1 * n_fl
#for all plants that developed to assign those 23 a value,
#and based on this, calculate measure 1 (phen_avg) or 2 (julian3).
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
newdatarep
data5<-merge(data5,newdata,by="id_pl",all.x=T)
head(data5)
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#152,97,103
#Remove two outliers from Remmene where veg_h was >90 cm
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
#There were 26 plants where phenology did not change from t1 to t2
#Assign them a state at t2 based on what we would expect if development had continued
#Use the relationship: phen_index2 = phen_index1 + n_fl + phen_index1 * n_fl
#for all plants that developed to assign those 23 a value,
#and based on this, calculate measure 1 (phen_avg) or 2 (julian3).
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5<-merge(data5,newdata[c(1,4)],by="id_pl",all.x=T)
View(data5)
newdata$id_pl
str(newdata$id_pl)
str(data5$id_pl)
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#152,97,103
#Remove two outliers from Remmene where veg_h was >90 cm
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
#There were 26 plants where phenology did not change from t1 to t2
#Assign them a state at t2 based on what we would expect if development had continued
#Use the relationship: phen_index2 = phen_index1 + n_fl + phen_index1 * n_fl
#for all plants that developed to assign those 23 a value,
#and based on this, calculate measure 1 (phen_avg) or 2 (julian3).
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5$id_pl<-droplevels(data5$id_pl)
newdatarep$id_pl<-droplevels(newdatarep$id_pl)
str(data5$id_pl)
str(newdatarep$id_pl)
data5<-merge(data5,newdata[c(1,4)],by="id_pl",all.x=T)
str(data5$id_pl)
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
subset(data5,is.na(phen_indexc))
subset(data5,is.na(phen_index2c))
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#152,97,103
#Remove two outliers from Remmene where veg_h was >90 cm
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
#There were 26 plants where phenology did not change from t1 to t2
#Assign them a state at t2 based on what we would expect if development had continued
#Use the relationship: phen_index2 = phen_index1 + n_fl + phen_index1 * n_fl
#for all plants that developed to assign those 23 a value,
#and based on this, calculate measure 1 (phen_avg) or 2 (julian3).
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5$id_pl<-droplevels(data5$id_pl)
newdatarep$id_pl<-droplevels(newdatarep$id_pl)
str(data5$id_pl)
str(newdatarep$id_pl)
data5$id_pl
data5<-merge(data5,newdata[c(1,4)],by="id_pl",all.x=T)
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
head(data5)
newdatarep
tail(data5)
subset(data5,is.na(phen_index2c))
data5$id_pl<-as.character(data5$id_pl)
newdatarep$id_pl<-as.character(newdatarep$id_pl)
str(newdatarep)
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#152,97,103
#Remove two outliers from Remmene where veg_h was >90 cm
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
#There were 26 plants where phenology did not change from t1 to t2
#Assign them a state at t2 based on what we would expect if development had continued
#Use the relationship: phen_index2 = phen_index1 + n_fl + phen_index1 * n_fl
#for all plants that developed to assign those 23 a value,
#and based on this, calculate measure 1 (phen_avg) or 2 (julian3).
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5$id_pl<-droplevels(data5$id_pl)
newdatarep$id_pl<-droplevels(newdatarep$id_pl)
str(data5$id_pl)
str(newdatarep$id_pl)
data5$id_pl<-as.character(data5$id_pl)
newdatarep$id_pl<-as.character(newdatarep$id_pl)
str(data5$id_pl)
str(newdatarep$id_pl)
data5<-merge(data5,newdata[c(1,4)],by="id_pl",all.x=T)
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
subset(data5,is.na(phen_index2c))
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#152,97,103
#Remove two outliers from Remmene where veg_h was >90 cm
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
#There were 26 plants where phenology did not change from t1 to t2
#Assign them a state at t2 based on what we would expect if development had continued
#Use the relationship: phen_index2 = phen_index1 + n_fl + phen_index1 * n_fl
#for all plants that developed to assign those 23 a value,
#and based on this, calculate measure 1 (phen_avg) or 2 (julian3).
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5<-merge(data5,newdatarep[c(1,4)],by="id_pl",all.x=T)
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
subset(data5,is.na(phen_index2c))
?complete.cases
str(data5)
data5<-complete.cases(data5)
str(data5)
data5<-rbind(data4A,data4B)
head(data5)
str(data5)
with(data5,table(population))#152,97,103
#Remove two outliers from Remmene where veg_h was >90 cm
data5<-subset(data5,veg_h_mean<90)
str(data5) #350 obs
with(data5,table(population))#152,95,103
#There were 26 plants where phenology did not change from t1 to t2
#Assign them a state at t2 based on what we would expect if development had continued
#Use the relationship: phen_index2 = phen_index1 + n_fl + phen_index1 * n_fl
#for all plants that developed to assign those 23 a value,
#and based on this, calculate measure 1 (phen_avg) or 2 (julian3).
data5$phen_index_diff<-data5$phen_index2-data5$phen_index1
model1rep<-lm(phen_index2~phen_index1*n_fl,data=subset(data5,phen_index_diff>0))
summary(model1rep) #R2=0.44
nobs(model1rep) #323 plants
plot(model1rep) #meh
newdatarep<-subset(data5,phen_index_diff==0)[c(1,15,26)]
newdatarep$phen_index2_pred<-predict(model1rep,newdatarep)
newdatarep
data5<-merge(data5,newdatarep[c(1,4)],by="id_pl",all.x=T)
data5$phen_index2c<-ifelse(data5$phen_index_diff>0,data5$phen_index2,data5$phen_index2_pred)
subset(data5,is.na(phen_index2c))
str(data5)
data5 <- data5[-which(data5$id_pl == "H10_15_008"), ]
str(data5)
with(data5,hist(phen_index2))
with(data5,hist(phen_index2c))
data5$phen_index_avg<-(data5$phen_index1+data5$phen_index2c)/2
with(data5,hist(phen_index_avg))
data5$phen_index_avg
data5$over_veg<-data5$shoot_h-data5$veg_h_mean
model_eggs_rep<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*pop,data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_rep<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*population,data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
models_eggs_rep<-dredge(model_eggs_rep)
summary(model.avg(models_eggs_rep, subset = delta < 2))
models_eggs_rep[1]
model_eggs_rep_best<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_rep_best)
model_eggs_rep_best<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants_mean),data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_rep_best<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_rep_best)
nullmodel_eggs_rep<-hurdle(n_eggs_max~1,data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
2*logLik(model_eggs_rep)     # Deviance model_eggs
2*logLik(nullmodel_eggs_rep)  # Deviance null model
(-1712.712-(-1648.488))/-1712.712 # Only 3.8% !?
model_eggs_H<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="H"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_R<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="R"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_H)
summary(model_eggs_R)
summary(model_eggs_T)
model_eggs_T<-hurdle(n_eggs_max~phen_index_avg+over_veg+n_redants,data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_T)
model_eggs_T<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data3,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
models_eggs_H<-dredge(model_eggs_H)
models_eggs_R<-dredge(model_eggs_R)
models_eggs_T<-dredge(model_eggs_T)
summary(model.avg(models_eggs_H, subset = delta < 2))
summary(model.avg(models_eggs_R, subset = delta < 2))
summary(model.avg(models_eggs_T, subset = delta < 2))
model_eggs_H_rep<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data5,pop=="H"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
str(subset(data5,population=="Högsjön"))
model_eggs_H_rep<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg)+scale(n_redants),data=subset(data5,population=="Högsjön"),
dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_H_rep)
models_eggs_H_rep<-dredge(model_eggs_H_rep)
summary(model.avg(models_eggs_H_rep, subset = delta < 2))
models_eggs_H_rep[1]
model_eggs_H_rep_best<-hurdle(n_eggs_max~scale(over_veg)+scale(n_redants),data=data5,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_H_rep_best)
