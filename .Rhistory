models_eggs<-dredge(model_eggs)
models_eggs
models_eggs
summary(model.avg(models_eggs, subset = delta < 4))
summary(model.avg(models_eggs, subset = delta < 2))
summary(model_eggs_best)
NagelkerkeR2(model_eggs_best)
NagelkerkeR2(model_fruitset)
NagelkerkeR2(model_fruitset_best)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
plot(effect(term="meanT:veg_h_mean", mod=model_ants_best,
xlevels=list(veg_h_mean=5:60, meanT=seq(14,20,1))),multiline=T,type="response")
int_ants<-data.frame(effect(term="meanT:veg_h_mean", mod=model_ants_best,
xlevels=list(veg_h_mean=0:60, meanT=seq(14,20,1))))
ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) +
geom_line(size=0.3,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) +
geom_line(size=0.3,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")
with(data3,min(meanT))
with(data3,min(maxT))
with(data3,max(meanT))
summary(model.avg(models_ants, subset = delta < 2))
plot(effect(term="meanT:veg_h_mean", mod=model.avg(models_ants, subset = delta < 2),
xlevels=list(veg_h_mean=5:60, meanT=seq(14,20,1))),multiline=T,type="response")
?effect
int_ants
plot(effect(term="meanT:veg_h_mean", mod=model_ants_best,
xlevels=list(veg_h_mean=5:60, meanT=seq(14,20,1))),multiline=T,type="response")
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,gp=gpar(fontsize=16)))
dev.off()
p9<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~population)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Plant prominence")+
theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,gp=gpar(fontsize=16)))
??textGrob
install.packages(c("car", "coin", "curl", "data.table", "ggfortify", "ggthemes", "lmerTest", "miscTools", "qgraph"))
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,gp=gpar(fontsize=16)))
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(lme4)
library(ggthemr)
library(pscl)
library(effects)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
grid.arrange(p11, p12,left = textGrob("Number of intact fruits / Number of flowers", rot = 90,gp=gpar(fontsize=16)))
?grid.arrange
grid.arrange(p11, p12,left = "Number of intact fruits / Number of flowers"))
grid.arrange(p11, p12,left = "Number of intact fruits / Number of flowers")
grid.arrange(p11, p12,left = "Fruit set")
grid.arrange(p11, p12,left = "Fruit set",topright="A")
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = "Fruit set")
dev.off()
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
pdf("./results/figures/fig2_phen.pdf", family="Times",width=7,height=6)
grid.arrange(p7, p8,left = "Plant phenology")
dev.off()
?grid.arrange
p7<-ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
p8<-ggplot(data3, aes(veg_h_mean,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
grid.arrange(p7, p8,left = "Plant phenology")
p7<-ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
grid.arrange(p7, p8,left = "Plant phenology")
p7<-ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
p7<-ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
p8<-ggplot(data3, aes(veg_h_mean,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig2_phen.pdf", family="Times",width=7,height=6)
grid.arrange(p7, p8,left = "Plant phenology")
dev.off()
grid.arrange(p7, p8,left = "Plant phenology")
grid.arrange(p7, p8,left = "Plant phenology",top=textGrob("Title", gp=gpar(fontsize=15,font=8)))
grid.arrange(p7, p8,left = textGrob("Plant phenology", gp=gpar(fontsize=15,font=8)))
grid.arrange(p7, p8,left = textGrob("Plant phenology", gp=gpar(fontsize=15,rotation=90)))
grid.arrange(p7, p8,left = textGrob("Plant phenology", gp=gpar(fontsize=15,rot=90)))
grid.arrange(p7, p8,left = textGrob("Plant phenology", rot=90, gp=gpar(fontsize=16))
)
pdf("./results/figures/fig2_phen.pdf", family="Times",width=7,height=6)
grid.arrange(p7, p8,left = textGrob("Plant phenology", rot=90, gp=gpar(fontsize=16)))
dev.off()
p9<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+facet_grid(.~population)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Plant prominence")+
theme(plot.background=element_rect(fill="white", colour=NA))
p10<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+facet_grid(.~population)+
geom_smooth(method = "glm.nb", se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
multiplot(p9,p10,cols=1)
dev.off()
dev.off()
dev.off()
pdf("./results/figures/fig4_eggs.pdf", family="Times",width=7,height=6)
multiplot(p9,p10,cols=1)
dev.off()
grid.arrange(p11, p12,left = "Fruit set")
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
grid.arrange(p11, p12,left = textGrob("Fruit set" rot=90, gp=gpar(fontsize=16)))
grid.arrange(p11, p12,left = textGrob("Fruit set", rot=90, gp=gpar(fontsize=16)))
grid.arrange(p11, p12,left = textGrob("Fruit set", rot=90, gp=gpar(fontsize=16)))
p11<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
p12<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = textGrob("Fruit set", rot=90, gp=gpar(fontsize=16)))
dev.off()
str(subset(data3,n_eggs_max>0))
str(data3)
model_phen_H<-lm(phen_index_avg~scale(meanT)*scale(veg_h_mean),data=subset(data3,pop=="H"),na.action="na.fail")
model_phen_R<-lm(phen_index_avg~scale(meanT)*scale(veg_h_mean),data=subset(data3,pop=="R"),na.action="na.fail")
model_phen_T<-lm(phen_index_avg~scale(meanT)*scale(veg_h_mean),data=subset(data3,pop=="T"),na.action="na.fail")
summary(model_phen_H)
summary(model_phen_R)
summary(model_phen_T)
p11
p12
p13
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Plant prominence")+
theme(plot.background=element_rect(fill="white", colour=NA))
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Plant prominence")+
theme(plot.background=element_rect(fill="white", colour=NA))
multiplot(p9,p10,cols=1)
pdf("./results/figures/fig4_eggs_together.pdf", family="Times",width=7,height=6)
ggplot(data3, aes(over_veg,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Plant prominence")+
theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
p13<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Plant prominence")+
theme(plot.background=element_rect(fill="white", colour=NA))
p14<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
multiplot(p9,p10,cols=2)
multiplot(p13,p14,cols=2)
ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
annotate("text",  x=Inf, y = Inf, label = "Some text", vjust=1, hjust=1)
p13<-ggplot(data3, aes(over_veg,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Probability of having eggs")+
xlab("Plant prominence")+
theme(plot.background=element_rect(fill="white", colour=NA))
p14<-ggplot(subset(data3,n_eggs_max>0), aes(phen_index_avg,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig4_eggs_together.pdf", family="Times",width=7,height=6)
multiplot(p13,p14,cols=2)
dev.off()
pdf("./results/figures/fig4_eggs_together.pdf", family="Times",width=7,height=3)
multiplot(p13,p14,cols=2)
dev.off()
p15<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
p16<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=5.5)
grid.arrange(p15, p16,left = textGrob("Fruit set", rot=90, gp=gpar(fontsize=16)))
dev.off()
?grid.arrange
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=5.5)
grid.arrange(p15, p16,ncol=2,left = textGrob("Fruit set", rot=90, gp=gpar(fontsize=16)))
dev.off()
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=3)
grid.arrange(p15, p16,ncol=2,left = textGrob("Fruit set", rot=90, gp=gpar(fontsize=16)))
dev.off()
p15<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))
p16<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=3)
grid.arrange(p15, p16,ncol=2)
dev.off()
grid.arrange(p15, rectGrob(gp=gpar(col="white")), p16, widths=c(0.45, 0.05, 0.45), p16,ncol=3)
grid.arrange(p15, rectGrob(gp=gpar(col="white")), p16, widths=c(0.45, 0.05, 0.45), ncol=3)
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=3)
grid.arrange(p15, rectGrob(gp=gpar(col="white")), p16, widths=c(0.45, 0.05, 0.45), ncol=3)
dev.off()
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=3)
grid.arrange(p15, rectGrob(gp=gpar(col="white")), p16, widths=c(0.46, 0.03, 0.46), ncol=3)
dev.off()
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=3)
grid.arrange(p15, rectGrob(gp=gpar(col="white")), p16, widths=c(0.45, 0.05, 0.45), ncol=3)
dev.off()
p15
p16
p17
p18
dev.off()
pdf("./results/figures/fig1_temp.pdf", family="Times",width=7,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig1_temp_together.pdf", family="Times",width=7,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig1_temp_together.pdf", family="Times")
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig1_temp_together.pdf", family="Times",width=7,height=7)
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig1_temp_together.pdf", family="Times")
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig1_temp_together.pdf", family="Times",width=3,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 1)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
modelin1<-glm(cbind(n_intact_fruits,n_fl)~scale(n_eggs_max),
family="binomial",data=data3,na.action="na.fail")
summary(modelin1)
plot(residuals(modelin1))
residuals(modelin1)
hist(residuals(modelin1))
modelin2<-glm(residuals(modelin1)~scale(phen_index_avg),
family="gaussian",data=data3,na.action="na.fail")
summary(modelin2)
modelin3<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index_avg),
family="binomial",data=data3,na.action="na.fail")
summary(modelin3)
ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(phen_index_avg, residuals(modelin1))) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(phen_index_avg, residuals(modelin1))) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "gaussian"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
rm(modelin2)
rm(modelin1)
rm(modelin)
rm(modelin3)
with(data3,plot(attack,fruit_set))
with(data3,plot(as.factor(attack),fruit_set))
with(data3,lineplot.CI(as.factor(attack),fruit_set))
??lineplot.CI
with(data3,lineplot.CI(fruit_set~as.factor(attack)))
library(sciplot)
with(data3,lineplot.CI(fruit_set~as.factor(attack)))
with(data3,lineplot.CI(as.factor(attack),fruit_set))
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+attack+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=data3,na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=data3,na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=subset(data3,n_eggs_max>0),na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(log(n_eggs_max+1))+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=data3,na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=data3,na.action="na.fail")
summary(model_fruitset)
_
_
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data=data3,na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2)) # Phen, eggs and pop *, no interactions
?complete.cases
p11<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
p12<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~population)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=7,height=5.5)
grid.arrange(p11, p12,left = textGrob("Fruit set", rot=90, gp=gpar(fontsize=16)))
dev.off()
p15<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
p16<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=3)
grid.arrange(p15, rectGrob(gp=gpar(col="white")), p16, widths=c(0.45, 0.05, 0.45), ncol=3)
dev.off()
p15<-ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
p16<-ggplot(data3, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Plant phenology")+ylab(NULL)+
theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig5_fruitset_together.pdf", family="Times",width=7,height=3)
grid.arrange(p15, rectGrob(gp=gpar(col="white")), p16, widths=c(0.45, 0.05, 0.45), ncol=3)
dev.off()
16+18+3+24+15+4
model_phen<-lm(phen_index_avg~(scale(meanT)*scale(veg_h_mean))*pop,data=data3,na.action="na.fail")
summary(model_phen)
summary(model.avg(models_phen, subset = delta < 2))
models_phen[1]
library(MuMIn)
summary(model.avg(models_phen, subset = delta < 2))
model_phen<-lm(phen_index_avg~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_phen)
models_phen<-dredge(model_phen)
summary(model.avg(models_phen, subset = delta < 2))
models_phen[1]
summary(model_phen)
model_phen_best<-lm(phen_index_avg~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_phen_best)
model_phen_H<-lm(phen_index_avg~scale(meanT),data=subset(data3,pop=="H"),na.action="na.fail")
model_phen_R<-lm(phen_index_avg~scale(meanT),data=subset(data3,pop=="R"),na.action="na.fail")
model_phen_T<-lm(phen_index_avg~scale(meanT),data=subset(data3,pop=="T"),na.action="na.fail")
summary(model_phen_H)
summary(model_phen_R)
summary(model_phen_T)
summary(model.avg(models_phen, subset = delta < 2))
summary(model_phen_best)
print.xtable(xtable(xtable(summary(model_phen_best)),
digits=c(0,3,3,3,2,3)), type="html",file="./results/tables/model_phen.html")
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
print.xtable(xtable(xtable(summary(model_phen_best)),
digits=c(0,3,3,3,2,3)), type="html",file="./results/tables/model_phen.html")
summary(model_phen_best)
summary(model.avg(models_temp, subset = delta < 2))
print.xtable(xtable(xtable(summary(model_phen_best)),
digits=c(0,3,3,2,3)), type="html",file="./results/tables/model_phen.html")
model_phen_H<-lm(phen_index_avg~scale(meanT),data=subset(data3,pop=="H"),na.action="na.fail")
model_phen_R<-lm(phen_index_avg~scale(meanT),data=subset(data3,pop=="R"),na.action="na.fail")
model_phen_T<-lm(phen_index_avg~scale(meanT),data=subset(data3,pop=="T"),na.action="na.fail")
summary(model_phen_H)
summary(model_phen_R)
summary(model_phen_T)
print.xtable(xtable(model_phen_H,digits=c(0,3,3,2,3)),type="html",file="./results/tables/model_phen_H.html")
print.xtable(xtable(model_phen_R,digits=c(0,3,3,2,3)),type="html",file="./results/tables/model_phen_R.html")
print.xtable(xtable(model_phen_T,digits=c(0,3,3,2,3)),type="html",file="./results/tables/model_phen_T.html")
pdf("./results/figures/fig2_phen.pdf", family="Times",width=7,height=6)
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig2_phen.pdf", family="Times",width=3,height=3)
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig2_phen.pdf", family="Times",width=6,height=3)
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig2_phen.pdf", family="Times",width=6,height=3)
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+ylab("Plant phenology")+theme(plot.background=element_rect(fill="white", colour=NA))
pdf("./results/figures/fig2_phen.pdf", family="Times",width=6,height=3)
ggplot(data3, aes(meanT,phen_index_avg)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab(NULL)+
geom_point(size = 1)+ theme_base()+ xlab("Soil temperature")+ylab("Plant phenology")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
summary(model_phen_H)
summary(model_phen_R)
summary(model_phen_T)
