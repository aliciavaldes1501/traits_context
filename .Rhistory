data1<-read.table("./data/clean/datafile1.txt",header=T,sep="\t",dec=",")
head(data1)
tail(data1)
str(data1)
#Construct new variable
#Is plant higher than vegetation?
data1$higher_veg_max<-as.factor(with(data1,ifelse(diff_veg_h_max_shoot_h<0,"1","0")))
data1$higher_veg_mean<-as.factor(with(data1,ifelse(diff_veg_h_mean_shoot_h<0,"1","0")))
#Construct new variable: attack
data1$attack<-as.factor(with(data1,ifelse(n_eggs_max>0,"1","0")))
#Construct new variable: redants_pres
data1$redants_pres<-as.factor(with(data1,ifelse(n_redants>0,"1","0")))
#Construct new variable: prop_pred
data1$prop_pred<-with(data1,n_predated/n_fl_corrected)
#Construct new variable: observation-level random effect
data1$id<-1:309
summary(data1)
names(data1)
with(data1,plot(attack,most_adv))
with(data1,summary(lm(most_adv~attack)))
with(data1,summary(lm(fruit_set~attack)))
with(data1,plot(attack,n_fruits_total))
with(data1,summary(lm(n_fruits_total~attack)))
library(PerformanceAnalytics)
head(data1[c(4,7,18,21:27,31)])
data1corr<-data1[c(4,7,18,21:27,31)]
chart.Correlation(data1corr)
head(data1[c(3:9,17:29,31:34)])
data1corr<-data1[c(3:9,17:29,31:34)]
cor(data1corr,use="pairwise.complete.obs" )
write.table(cor(data1corr,use="pairwise.complete.obs" ),"clipboard",sep="\t")
head(data1[c(3,17:18,21:26,31,34)])
data1corr<-data1[c(3,17:18,21:26,31,34)]
chart.Correlation(data1corr,pch=20)
warnings()
xyplot(phen_index~avg_d_mean | population,
panel=function(x, y){
panel.xyplot(x, y)
panel.lmline(x, y, lty = 2)  # Least squares broken line
}
)
for (i in 3:ncol(data1)){boxplot(as.numeric(data1[,i]),main=paste(colnames(data1)[i]))}
for (i in 3:ncol(data1)){hist(as.numeric(data1[,i]),main=paste(colnames(data1)[i]))}
par(mfrow=c(1,3),
oma = c(5,4,1,1) + 0.1,
mar = c(3,3,2,2) + 0.1)
for (i in c(3:9,16:18,21:27,31:39)){plot(data1$population,data1[,i],main=paste(colnames(data1)[i]))}
for (i in 3:9){print(summary(aov(as.numeric(data1[,i])~data1$population)))}
for (i in 16:ncol(data1)){print(summary(aov(as.numeric(data1[,i])~data1$population)))}
for (i in 3:9){print(TukeyHSD(aov(as.numeric(data1[,i])~population)))}
for (i in 16:ncol(data1)){print(TukeyHSD(aov(as.numeric(data1[,i])~population)))}
library(vcd)
library(MASS)
x<-seq(0,100,0.01)
hist(data1$n_eggs_max, prob=TRUE)
curve(dnorm(x, mean=mean(data1$n_eggs_max), sd=sd(data1$n_eggs_max)), add=TRUE)
fitdistr(data1$n_eggs_max,"poisson")
summary(goodfit(data1$n_eggs_max,type="poisson"))
cor(data1[c(3:4,7:9,17:18,25,27,31,39)],use="pairwise.complete.obs")
plot(avg_d_mean,n_redants,pch=20)
plot(avg_d_mean,n_redants,pch=20)
abline(lm(n_redants~avg_d_mean))
summary(lm(n_redants~avg_d_mean))
text(x = 12.8, y = 58, labels = "p<0.001")
summary(with(subset(data1,population=="Högsjön"),lm(n_redants~avg_d_mean)))
summary(with(subset(data1,population=="Remmene"),lm(n_redants~avg_d_mean)))
summary(with(subset(data1,days_datalog==33),lm(n_redants~avg_d_mean)))
xyplot(n_redants~avg_d_mean,
groups=population,
par.settings=simpleTheme(pch=20,cex=1.3),
panel = panel.superpose,
panel.groups=function(x, y, col, col.symbol, ...) {
panel.xyplot(x, y, col=col.symbol, ...)
panel.lmline(x, y, col.line=col.symbol)
},
grid = F,
auto.key = list(title='Population',
text=c("H  p=0.391", "R  p=0.0315", "T  p=0.0417"),
corner = c(0,1), cex=1.0)
)
summary(with(subset(data1,population=="Högsjön"),lm(avg_d_mean~veg_h_mean)))
summary(with(subset(data1,population=="Remmene"),lm(avg_d_mean~veg_h_mean)))
summary(with(subset(data1,days_datalog==33),lm(avg_d_mean~veg_h_mean)))
plot(veg_h_mean,diff_veg_h_mean_shoot_h)
summary(lm(diff_veg_h_mean_shoot_h~veg_h_mean))
abline(lm(diff_veg_h_mean_shoot_h~veg_h_mean))
data1$color<-ifelse(data1$population=="Högsjön","red",ifelse(data1$population=="Remmene","green","blue"))
data1comp$color<-ifelse(data1comp$population=="Högsjön","red",ifelse(data1comp$population=="Remmene","green","blue"))
?ggbiplot
library(ggbiplot)
dataseeds1<-read.table("./data/clean/seeds_up_p_means.txt",header=T,sep="\t",dec=",")
head(dataseeds1)
head(dataseeds1)
dataseeds2<-read.table("./data/clean/seeds_means.txt",header=T,sep="\t",dec=",")
head(dataseeds2)
with(subset(dataseeds2,!is.na(n_dev)),interaction.plot(ripe_when_collect,population2,n_dev,type="b",
ylim=c(100,600),col=c(1:3), lwd=2, pch=c(15,16,17)))
data2<-read.table("./data/clean/datafile1_seeds.txt",header=T,sep="\t",dec=",")
head(data2)
tail(data2)
str(data2)
str(data1)
ggplot(data1comp, aes(n_eggs_max, n_intact_fruits,colour = population)) +
geom_smooth(method = "glm", se = F,
method.args = list(family = "poisson"))+
geom_point(size = 2)
data1comp<-data1[complete.cases(data1[37:54]),]
ggplot(data1comp, aes(n_eggs_max, n_intact_fruits,colour = population)) +
geom_smooth(method = "glm", se = F,
method.args = list(family = "poisson"))+
geom_point(size = 2)
ggplot(data1comp, aes(most_adv, n_eggs_max,colour = population)) +
geom_smooth(method = "glm", se = T,
method.args = list(family = "poisson"))+
geom_point(size = 2)
ggplot(data1comp, aes(avg_day_min_ja, n_eggs_max,colour = population)) +
geom_smooth(method = "glm",  se = T,
method.args = list(family = "poisson"))+
geom_point(size = 2)
ggplot(data1comp, aes(avg_day_min_ja, n_eggs_max,colour = population)) +
geom_smooth(method = MASS::glm.nb,  se = T)+
geom_point(size = 2)
phen_revised<-read.table("phen_revised.txt",header=T,sep="\t",dec=".")
head(phen_revised)
phen_revised<-read.table(".data/clean/phen_revised.txt",header=T,sep="\t",dec=".")
head(phen_revised)
phen_revised<-read.table(".data/clean/phen_revised.txt",header=T,sep="\t",dec=".")
phen_revised<-read.table(".data/clean/phen_revised.txt",header=T,sep="\t",dec=".")
phen_revised<-read.table(".data/clean/datafile1.txt",header=T,sep="\t",dec=".")
data1<-read.table("./data/clean/datafile1.txt",header=T,sep="\t",dec=",")
phen_revised<-read.table("./data/clean/phen_revised.txt",header=T,sep="\t",dec=".")
head(phen_revised)
head(phen_revised)
phen_revised<-read.table("./data/clean/data_phen_revised.txt",header=T,sep="\t",dec=".")
head(phen_revised)
buds_eggs<-read.table(".data/clean/buds_eggs.txt",header=T,sep=",",dec=".")
buds_eggs<-read.table("./data/clean/buds_eggs.txt",header=T,sep=",",dec=".")
head(buds_eggs)
library(vcd)
library(MASS)
library(PerformanceAnalytics)
data1<-read.table("./data/clean/datafile1.txt",header=T,sep="\t",dec=",")
head(data1)
tail(data1)
str(data1)
data1$higher_veg_max<-as.factor(with(data1,ifelse(diff_veg_h_max_shoot_h<0,"1","0")))
data1$higher_veg_mean<-as.factor(with(data1,ifelse(diff_veg_h_mean_shoot_h<0,"1","0")))
data1<-read.table("./data/clean/datafile1.txt",header=T,sep="\t",dec=",")
head(data1)
tail(data1)
str(data1)
data1$attack<-as.factor(with(data1,ifelse(n_eggs_max>0,"1","0")))
summary(data1)
names(data1)
with(data1,plot(attack,most_adv))
with(data1,summary(lm(most_adv~attack)))
with(data1,summary(lm(fruit_set~attack)))
with(data1,plot(attack,n_fruits_total))
with(data1,summary(lm(n_fruits_total~attack)))
head(data1)
summary(data1)
names(data1)
head(data1[c(4,7,18,21:27,31)])
data1corr<-data1[c(4,7,18,21:27,31)]
chart.Correlation(data1corr)
png("./results/figures/correlation_chart_data1", width=480, height=480)
warnings()
png("./results/figures/correlation_chart_data1", width=480, height=480)
png("./results/figures/correlation_chart_data1.png", width=480, height=480)
png("./results/figures/correlation_chart_data1.png", width=480, height=480)
chart.Correlation(data1corr)
dev.off()
png("./results/figures/correlation_chart_data1.png", width=480, height=480)
chart.Correlation(data1corr)
library(vcd)
library(MASS)
library(PerformanceAnalytics)
chart.Correlation(data1corr)
dev.off()
tiff("./results/figures/correlation_chart_data1.tiff", res=300,width=480, height=480)
chart.Correlation(data1corr)
dev.off()
?tiff
tiff("./results/figures/correlation_chart_data1.tiff", res=300,width=15, height=15,units=cm)
chart.Correlation(data1corr)
tiff("./results/figures/correlation_chart_data1.tiff", res=300,width=15, height=15,units=cm)
tiff("./results/figures/correlation_chart_data1.tiff", res=300,width=15, height=15,units="cm")
chart.Correlation(data1corr)
dev.off()
tiff("./results/figures/correlation_chart_data1.tiff", res=600,width=15, height=15,units="cm")
chart.Correlation(data1corr)
dev.off()
?pdf
pdf("./results/figures/correlation_chart_data1.tiff", res=300,width=15, height=15,units="cm",family="Times")
pdf("./results/figures/correlation_chart_data1.tiff", family="Times")
chart.Correlation(data1corr)
dev.off()
warnings()
pdf("./results/figures/correlation_chart_data1.tiff", family="Times")
chart.Correlation(data1corr)
dev.off()
head(data1corr)
pdf("./results/figures/correlation_chart_data1.tiff", family="Times")
plot(data1corr$most_adv)
dev.off()
pdf("./results/figures/correlation_chart_data1.pdf", family="Times")
chart.Correlation(data1corr)
dev.off()
head(data1[c(3:9,17:29,31:34)])
data1corr<-data1[c(3:9,17:29,31:34)]
cor(data1corr,use="pairwise.complete.obs" )
write.table(cor(data1corr,use="pairwise.complete.obs" ),"clipboard",sep="\t")
?xtable
??xtable
library(xtable)
?xtable
methods(xtable)
cor(data1corr,use="pairwise.complete.obs" )
round(cor(data1corr,use="pairwise.complete.obs" ),2)
cortable<-round(cor(data1corr,use="pairwise.complete.obs" ),2)
cortable
lower.tri(cortable, diag = FALSE)
cortable<-round(cor(data1corr,use="pairwise.complete.obs" ),2)
cortable[lower.tri(cortable)]<-""
cortable<-as.data.frame(cortable)
cortable
cortable<-round(cor(data1corr,use="pairwise.complete.obs" ),2)
cortable[upper.tri(cortable)]<-""
cortable<-as.data.frame(cortable)
cortable
print(xtable(cortable), type="html")
print(xtable(cortable), type="html")
for (i in 3:ncol(data1)){boxplot(as.numeric(data1[,i]),main=paste(colnames(data1)[i]))}
for (i in 3:ncol(data1)){hist(as.numeric(data1[,i]),main=paste(colnames(data1)[i]))}
par(mfrow=c(1,3),
oma = c(5,4,1,1) + 0.1,
mar = c(3,3,2,2) + 0.1)
for (i in c(3:9,16:18,21:27,31:39)){plot(data1$population,data1[,i],main=paste(colnames(data1)[i]))}
for (i in 3:9){print(summary(aov(as.numeric(data1[,i])~data1$population)))}
for (i in 16:ncol(data1)){print(summary(aov(as.numeric(data1[,i])~data1$population)))}
for (i in 3:9){print(TukeyHSD(aov(as.numeric(data1[,i])~population)))}
for (i in 16:ncol(data1)){print(TukeyHSD(aov(as.numeric(data1[,i])~population)))}
for (i in c(3:9,16:18,21:27,31:39)){plot(data1$population,data1[,i],main=paste(colnames(data1)[i]))}
pdf("./results/figures/diffs_pops_data1.pdf", family="Times")
for (i in c(3:9,16:18,21:27,31:39)){plot(data1$population,data1[,i],main=paste(colnames(data1)[i]))}
dev.off()
cor(data1[c(3:4,7:9,17:18,25,27,31,39)],use="pairwise.complete.obs")
library(lme4)
library(sciplot)
library(RVAideMemoire)
library(lmerTest)
install.packages("ade4")
install.packages("acepack")
install.packages("ggplot2")
install.packages(c("colorspace", "corrgram", "effects", "gamlss", "git2r", "hms", "htmlwidgets", "installr"))
install.packages(c("irlba", "jsonlite", "kernlab", "knitr", "lavaan", "mgcv", "miscTools", "mixOmics", "mnormt"))
install.packages(c("openssl", "permute", "proto", "psych", "qgraph", "quantmod", "R6", "Rcmdr", "rcompanion", "Rcpp", "reshape2", "rgdal"))
install.packages(c("qgraph", "rmarkdown", "Rmpfr", "RVAideMemoire", "shiny", "sjmisc", "sjPlot", "sjstats", "SparseM", "statmod", "stringdist", "stringi", "vcd", "vegan", "visNetwork", "XML", "yaml"))
install.packages("qgraph")
install.packages("qgraph")
library(lme4)
library(sciplot)
library(RVAideMemoire)
library(lmerTest)
dataseeds1<-read.table("./data/clean/seeds_up_p_means.txt",header=T,sep="\t",dec=",")
head(dataseeds1)
tail(dataseeds1)
str(dataseeds1)
hist(dataseeds1$n_dev)
hist(log(dataseeds1$n_dev)+1)
hist(dataseeds1$perc_dev)
hist(dataseeds1$mean_w_dev_mcg)
mod1<-glmer(round(n_dev)~p_up+(1|pl_id),family="poisson",data=dataseeds1)
summary(mod1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="Number of developed seeds",type="p",bty="l",legend=F))
overdisp.glmer(mod1) #There is overdispersion
dataseeds1$id<-1:60
mod1<-glmer(round(n_dev)~p_up+(1|pl_id)+(1|id),family="poisson",data=dataseeds1)
summary(mod1)
overdisp.glmer(mod1) #There is not overdispersion! - Model OK
pdf("./results/figures/diff_nseeds_p_up.pdf", family="Times")
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="Number of developed seeds",type="p",bty="l",legend=F))
dev.off()
dataseeds1$prop_dev<-cbind(round(dataseeds1$n_dev),round(dataseeds1$n_total))
mod2<-glmer(prop_dev~p_up+(1|pl_id),family="binomial",data=dataseeds1)
summary(mod2)
pdf("./results/figures/diff_percseeds_p_up.pdf", family="Times")
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="Percentage of developed seeds from total",type="p",bty="l",legend=F))
dev.off()
overdisp.glmer(mod2) #There is overdispersion
mod2<-glmer(prop_dev~p_up+(1|pl_id)+(1|id),family="binomial",data=dataseeds1)
summary(mod2)
overdisp.glmer(mod2) #There is not overdispersion! - Model OK
mod3<-lmer(mean_w_dev_mcg~p_up+(1|pl_id),data=dataseeds1)
summary(mod3)
pdf("./results/figures/diff_seedweight_p_up.pdf", family="Times")
dev.off()
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Mean seed weight for developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
pdf("./results/figures/diff_seedweight_p_up.pdf", family="Times")
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Mean seed weight for developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="N developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="% developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Weight developed seeds (µg)",type="p",bty="l",legend=F))
pdf("./results/figures/seeds_p_up.pdf", family="Times")
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="N developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="% developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Weight developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
?pdf
pdf("./results/figures/seeds_p_up.pdf", family="Times",width=7,height=3)
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds1,lineplot.CI(p_up,n_dev,cex=2,
xlab="",ylab="N developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,perc_dev,cex=2,
xlab="",ylab="% developed seeds",type="p",bty="l",legend=F))
with(dataseeds1,lineplot.CI(p_up,mean_w_dev_mcg,cex=2,
xlab="",ylab="Weight developed seeds (µg)",type="p",bty="l",legend=F))
dev.off()
par(mfrow=c(1,1),cex.lab=1)
with(subset(dataseeds1,!is.na(n_dev)),interaction.plot(ripe_when_collect,p_up,n_dev,type="b",
ylim=c(100,600),col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds1,!is.na(perc_dev)),interaction.plot(ripe_when_collect,p_up,perc_dev,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds1,!is.na(mean_w_dev_mcg)),interaction.plot(ripe_when_collect,p_up,mean_w_dev_mcg,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
dataseeds2<-read.table("./data/clean/seeds_means.txt",header=T,sep="\t",dec=",")
head(dataseeds2)
tail(dataseeds2)
str(dataseeds2)
dataseeds2$prop_dev<-cbind(round(dataseeds2$n_dev),round(dataseeds2$n_total))
hist(dataseeds2$n_dev)
hist(dataseeds2$perc_dev)
hist(dataseeds2$mean_w_dev_mcg)
mod3<-glmer(round(n_dev)~population2+(1|pl_id),family="poisson",data=dataseeds2)
summary(mod3)
overdisp.glmer(mod3)
dataseeds2$id<-1:179
mod3<-glmer(round(n_dev)~population2+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod3)
overdisp.glmer(mod3)
mod4<-glmer(prop_dev~population2+(1|pl_id),family="binomial",data=dataseeds2)
summary(mod4)
overdisp.glmer(mod4)
mod4<-glmer(prop_dev~population2+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod4)
overdisp.glmer(mod4)
mod5<-lmer(mean_w_dev_mcg~population2+(1|pl_id),data=dataseeds2)
summary(mod5)
with(dataseeds2,lineplot.CI(population2,n_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=F))
pdf("./results/figures/seeds_pops.pdf", family="Times",width=7,height=3)
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds2,lineplot.CI(population2,n_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,perc_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Percentage of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,mean_w_dev_mcg,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Weight developed seeds (µg)",type="p",cex=2,bty="l",legend=F))
dev.off()
pdf("./results/figures/seeds_pops.pdf", family="Times",width=9,height=3)
par(mfrow=c(1,3),cex=0.8,cex.lab=1.1)
with(dataseeds2,lineplot.CI(population2,n_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,perc_dev,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Percentage of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(population2,mean_w_dev_mcg,group=population2,pch=c(20,20,20),
xlab="Population",ylab="Weight developed seeds (µg)",type="p",cex=2,bty="l",legend=F))
dev.off()
mod6<-glmer(round(n_dev)~ripe_when_collect+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod6)
overdisp.glmer(mod6)
mod7<-glmer(prop_dev~ripe_when_collect+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod7)
overdisp.glmer(mod7)
mod8<-lmer(mean_w_dev_mcg~ripe_when_collect+(1|pl_id),data=dataseeds2)
summary(mod8)
with(dataseeds2,lineplot.CI(ripe_when_collect,n_dev,group=population2,
xlab="",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=T))
?lineplot.CI
with(dataseeds2,lineplot.CI(ripe_when_collect,n_dev,group=population2,
xlab="",ylab="Number of developed seeds",type="p",cex=2,bty="l",legend=T))
with(dataseeds2,lineplot.CI(ripe_when_collect,perc_dev,group=population2,
xlab="",ylab="Percentage of developed seeds",type="p",cex=2,bty="l",legend=F))
with(dataseeds2,lineplot.CI(ripe_when_collect,mean_w_dev_mcg,group=population2,
xlab="",ylab="Weight developed seeds (µg)",type="p",cex=2,bty="l",legend=F))
mod9<-glmer(round(n_dev)~ripe_when_collect*population2+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod9)
Anova(mod9,type="II")
mod10<-glmer(prop_dev~ripe_when_collect*population2+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod10)
Anova(mod10,type="II")
mod11<-lmer(mean_w_dev_mcg~ripe_when_collect*population2+(1|pl_id),data=dataseeds2)
summary(mod11)
Anova(mod11,type="II")
with(subset(dataseeds2,!is.na(n_dev)),interaction.plot(ripe_when_collect,population2,n_dev,type="b",
ylim=c(100,600),col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(perc_dev)),interaction.plot(ripe_when_collect,population2,perc_dev,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(mean_w_dev_mcg)),interaction.plot(ripe_when_collect,population2,mean_w_dev_mcg,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
mod12<-glmer(round(n_dev)~ripe_when_collect*p_up+(1|pl_id)+(1|id),family="poisson",data=dataseeds2)
summary(mod12)
Anova(mod12,type="II")
mod13<-glmer(prop_dev~ripe_when_collect*p_up+(1|pl_id)+(1|id),family="binomial",data=dataseeds2)
summary(mod13)
Anova(mod13,type="II")
mod14<-lmer(mean_w_dev_mcg~ripe_when_collect*p_up+(1|pl_id),data=dataseeds2)
summary(mod14)
library(car)
summary(mod13)
Anova(mod13,type="II")
mod14<-lmer(mean_w_dev_mcg~ripe_when_collect*p_up+(1|pl_id),data=dataseeds2)
summary(mod14)
Anova(mod14,type="II")
with(subset(dataseeds2,!is.na(n_dev)),interaction.plot(ripe_when_collect,p_up,n_dev,type="b",
ylim=c(100,600),col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(perc_dev)),interaction.plot(ripe_when_collect,p_up,perc_dev,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
with(subset(dataseeds2,!is.na(mean_w_dev_mcg)),interaction.plot(ripe_when_collect,p_up,mean_w_dev_mcg,type="b",
col=c(1:3), lwd=2, pch=c(15,16,17)))
?interaction.plot
head(dataseeds2)
library(plyr)
loggers<-read.table(".data/clean/raw_data_loggers.txt",header=T,sep="\t",dec=".")
loggers<-read.table("./data/clean/raw_data_loggers.txt",header=T,sep="\t",dec=".")
head(loggers)
str(loggers)
loggers$date<-as.Date(loggers$date,format="%m/%d/%Y")
head(loggers)
loggers<-subset(loggers,date<"2015-09-01")
loggers$timeday<-ifelse(loggers$hour==1|loggers$hour==4|loggers$hour==22,yes="night",no="day")
head(loggers)
loggers_day<-subset(loggers,timeday=="day")
loggers_day_agg<-ddply(loggers_day,c("pop", "id_pl","date"), summarise,
meanT = mean(LogData),
maxT = max(LogData),
minT = min(LogData),
sdT  = sd(LogData))
?dply
?ddply
loggers_day_agg$rangeT<-loggers_day_agg$maxT-loggers_day_agg$minT
head(loggers_day_agg)
loggers_day_agg<-aggregate(cbind(meanT, maxT, minT, sdT, rangeT) ~ pop + id_pl, data=loggers_day_agg, FUN=mean)
head(loggers_day_agg)
str(loggers_day_agg)
cor(loggers_day_agg[3:7])
library(ggplot2)
library(MASS)
library(MuMIn)
sessionInfo()
