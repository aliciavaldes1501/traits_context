theme_base()+xlab("Number of eggs")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
p10
pdf("./results/figures/fig5_fruitset.pdf", family="Times",width=3,height=3)
ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
dev.off()
pdf("./results/figures/fig3_fruitset.pdf", family="Times",width=3,height=3)
ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 1)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
dev.off()
pdf("./results/figures/fig3_fruitset.pdf", family="Times",width=3,height=3)
ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 0.5)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,color="black")+
theme_base()+xlab("Number of eggs")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
dev.off()
summary(model.avg(models_fruitset,subset=delta<2))
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# # # # # # # # # #  Final analyses to be included in paper # # # # # # # # #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
library(car)
library(grid)
library(cowplot)
summary(model.avg(models_fruitset,subset=delta<2))
summary(model_fruitset)
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+)*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2))
##Without Remmene (only 14 plants where fruitset>0)
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_eggs_max))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2))
model_phen<-lm(log(phen_index1)~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_phen)
summary(model.avg(models_phen, subset = delta < 2))
models_phen[1]
model_phen_best<-lm(log(phen_index1)~scale(meanT)+pop,data=data3,na.action="na.fail")
summary(model_phen_best) #R2=0.40
model_phen<-lm(phen_index1~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_phen)
with(data3,hist(phen_index))
with(data3,hist(phen_index1))
model_phen<-glm(phen_index1~scale(meanT)*pop,data=data3,na.action="na.fail",family="poisson")
warnings()
summary(model_phen)
models_phen<-dredge(model_phen)
summary(model.avg(models_phen, subset = delta < 2))
models_phen[1]
model_phen<-lm(log(phen_index1)~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_phen)
plot(model_phen)
summary(model_phen_best) #R2=0.40
summary(model_phen)
model_phen<-glm(log(phen_index1)~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_phen)
summary(model.avg(models_height, subset = delta < 2))
summary(model_height_best)#R2=
model_height<-lm(shoot_h~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_height)
plot(model_height)
models_height<-dredge(model_height)
summary(model.avg(models_height, subset = delta < 2))
summary(model.avg(models_ants, subset = delta < 2))
summary(model_height)
summary(model.avg(models_height, subset = delta < 2))
p7<-ggplot(data3, aes(meanT,phen_index1))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,color="black")+ylab(NULL)+
geom_point(size = 0.5)+ theme_base()+ xlab(NULL)+ylab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_x_continuous(limits = c(14,19))
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,color="black")+ylab(NULL)+
geom_point(size = 0.5)+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_x_continuous(limits = c(14,19))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) +
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
fig2ab<-plot_grid(p7,p8,ncol=1,align="v", rel_heights = c(1, 1.1))
pdf("./results/figures/fig2_phen_height_ants.pdf", family="Times",width=8,height=5)
plot_grid(fig2ab, NULL, p9, ncol = 3, rel_heights = c(1,1,1), align="v",rel_widths=c(6,0.07,8))
dev.off()
dev.off()
plot_grid(fig2ab, NULL, p9, ncol = 3, rel_heights = c(1,1,1), align="v",rel_widths=c(6,0.07,8))
dev.off()
dev.off()
fig2ab<-plot_grid(p7,p8,ncol=1,align="v", rel_heights = c(1, 1.1))
pdf("./results/figures/fig2_phen_height_ants.pdf", family="Times",width=8,height=5)
plot_grid(fig2ab, NULL, p9, ncol = 3, rel_heights = c(1,1,1), align="v",rel_widths=c(6,0.07,8))
dev.off()
with(data3,plot(meanT,shoot_h))
with(data3,abline(lm(shoot_h~meanT)))
with(data3,hist(shoot_d))
with(data3,hist(shoot_h))
model_height<-lm(shoot_h~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_height)
model_height<-lm(log(shoot_h)~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_height)
model_height<-lm(shoot_h~scale(meanT)*pop,data=data3,na.action="na.fail")
ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) +
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) +facet_grid(~pop)
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) +facet_grid(~pop)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) +facet_grid(~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) + facet_grid(.~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
int_ants
summary(model_ants_best)
summary(model_height)
summary(model.avg(models_height, subset = delta < 2))
summary(model_height_best)#R2=
summary(model_phen_best) #R2=0.40
library(nlme)
model_height<-lme(shoot_h~fixed=scale(meanT),random=scale(meanT)|pop,data=data3,na.action="na.fail")
model_height<-lme(shoot_h~scale(meanT),random=scale(meanT)|pop,data=data3,na.action="na.fail")
?lme
model_height<-lme(fixed=shoot_h~scale(meanT),random=scale(meanT)|pop,data=data3,na.action="na.fail")
names(data3)
model_height<-lme(fixed=shoot_h~meanT,random=meanT|pop,data=data3,na.action="na.fail")
model_height<-lmer(shoot_h~scale(meanT)+(scale(meanT)|pop),data=data3,na.action="na.fail")
summary(model_height)
library(lmerTESt)
library(lmerTest)
model_height<-lmer(shoot_h~scale(meanT)+(scale(meanT)|pop),data=data3,na.action="na.fail")
summary(model_height)
model_height<-lmer(shoot_h~scale(meanT)+(1|pop),data=data3,na.action="na.fail")
summary(model_height)
?lmer
model_height<-lmer(shoot_h~scale(meanT)+(scale(meanT)|pop),data=data3,na.action="na.fail")
summary(model_height)
plot(model_height)
model_height<-lmer(log(phen_index1)~scale(meanT)+(scale(meanT)|pop),data=data3,na.action="na.fail")
summary(model_height)
models_height<-dredge(model_height)
summary(model.avg(models_height, subset = delta < 2))
models_height[1]
model_height<-lmer(log(phen_index1)~scale(meanT)+(scale(meanT)|pop),data=data3,na.action="na.fail",REML=F)
summary(model_height)
models_height<-dredge(model_height)
summary(model.avg(models_height, subset = delta < 2))
models_height[1]
model_height<-lmer(log(phen_index1)~scale(meanT)+(1|pop),data=data3,na.action="na.fail",REML=F)
summary(model_height)
model_height<-lmer(log(phen_index1)~scale(meanT)+(1|pop),data=data3,na.action="na.fail")
summary(model_height)
model_height<-lm(shoot_h~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_height)
models_height<-dredge(model_height)
summary(model.avg(models_height, subset = delta < 2))
models_height[1]
model_height_best<-lm(shoot_h~scale(meanT)*pop,data=data3,na.action="na.fail")
summary(model_height_best)#R2=0.20
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# # # # # # # # # #  Final analyses to be included in paper # # # # # # # # #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
library(car)
library(grid)
library(cowplot)
model_height_H<-lm(shoot_h~scale(meanT),data=subset(data3,pop=="H"),na.action="na.fail")
model_height_R<-lm(shoot_h~scale(meanT),data=subset(data3,pop=="R"),na.action="na.fail")
model_height_T<-lm(shoot_h~scale(meanT),data=subset(data3,pop=="T"),na.action="na.fail")
summary(model_height_H)
summary(model_height_R)
summary(model_height_T)
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+attack)*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2))
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_eggs_max))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
summary(model.avg(models_fruitset,subset=delta<2))
n(model_fruitset)
n.obs(model_fruitset)
nobs(model_fruitset)
model_fruitset
with(data3,cor(phen_index1,shoot_h))
with(subset(data3,pop==H,cor(phen_index1,shoot_h))
with(subset(data3,pop==H),cor(phen_index1,shoot_h))
with(subset(data3,pop=="H"),cor(phen_index1,shoot_h))
with(subset(data3,pop=="R"),cor(phen_index1,shoot_h))
with(subset(data3,pop=="T"),cor(phen_index1,shoot_h))
?do
??do
?lmList
lmList(lm(log(phen_index1)~meanT))
lmList(lm(log(phen_index1)~meanT,data3))
lmList(log(phen_index1)~meanT,data3))
lmList(log(phen_index1)~meanT,data3)
lmList(formula=log(phen_index1)~meanT,data3)
lmList(formula=phen_index1~meanT,data3)
lmList(formula=phen_index1~meanT|pop,data3)
summary(lmList(formula=phen_index1~meanT|pop,data3))
names(data3)
data3$redants_pres<-as.factor(ifelse(n_redants>0,"1","0"))
data3$redants_pres<-as.factor(ifelse(data3$n_redants>0,"1","0"))
with(data3(hist(redants_pres)))
with(data3,hist(redants_pres))
with(data3,plot(redants_pres))
model_eggs<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+redants_pres)*pop,
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
models_eggs<-dredge(model_eggs)
summary(model.avg(models_eggs, subset = delta < 2)) #Table1
with(data3,plot(redants_pres,n_eggs_max))
with(subset(data3,n_eggs_max>0),plot(redants_pres,n_eggs_max))
with(data3,plot(redants_pres,attack))
with(data3,table(attack,pop))
?table
46/(46+53)
59/(59+34)
75/(75+28)
with(data3,cor(shoot_h,veg_h_mean))
with(data3,cor(shoot_h,meanT))
with(data3,cor(veg_h_mean,meanT))
with(subset(data3,pop=="H"),cor(shoot_h,veg_h_mean))
with(subset(data3,pop=="R"),cor(shoot_h,veg_h_mean))
with(subset(data3,pop=="T"),cor(shoot_h,veg_h_mean))
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# # # # # # # # # #  Final analyses to be included in paper # # # # # # # # #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
library(car)
library(grid)
library(cowplot)
?hurdle
model_eggs<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))+(1|pop),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs<-hurdle(n_eggs_max~scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+(1|pop),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs1<-glmer(attack~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*(1|pop),
data=data3,family="binomial",na.action="na.fail")
summary(model_eggs1)
model_eggs1<-glmer(attack~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)+
(scale(phen_index1)|pop)+(scale(shoot_h)|pop)+(scale(veg_h_mean)|pop)+(scale(n_redants)|pop),
data=data3,family="binomial",na.action="na.fail")
model_eggs1<-glmer(attack~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)+
(scale(phen_index1)|pop)+(scale(shoot_h)|pop)+(scale(veg_h_mean)|pop)+(scale(n_redants)|pop),
data=data3,family="binomial",na.action="na.fail")
summary(model_eggs1)
model_eggs1<-glmer(attack~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)+
(1+scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)|pop),
data=data3,family="binomial",na.action="na.fail")
summary(model_eggs1)
models_eggs1<-dredge(model_eggs1)
summary(model.avg(models_eggs1, subset = delta < 2))
model_eggs2<-glm.nb(n_eggs_max~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)+
(1+scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)|pop),
data=subset(data3,n_eggs_max>0),na.action="na.fail")
model_eggs2<-glmer.nb(n_eggs_max~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)+
(1+scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(n_redants)|pop),
data=subset(data3,n_eggs_max>0),na.action="na.fail")
summary(model_eggs2)
warnings()
models_eggs2<-dredge(model_eggs2)
summary(model.avg(models_eggs2, subset = delta < 2))
204+490+759
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
library(pscl)
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
models_eggs_extra<-dredge(model_eggs_extra)
library(MuMIn)
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
models_eggs_extra<-dredge(model_eggs_extra)
models_eggs_extra
?glm
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
?makeCluster
??makeCluster
library(parallel)
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data")
clusterEvalQ(clust, library(stats))
models_eggs_extra<-pdredge(model_eggs_extra,cluster=clust)
model_fruitset_extra<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
models_fruitset_extra<-dredge(model_fruitset_extra)
summary(model.avg(model_fruitset_extra,subset=delta<2))
models_fruitset_extra
head(models_fruitset_extra)
summary(model.avg(models_fruitset_extra,subset=delta<2))
model_fruitset_extra[1]
model_fruitset_extra_best<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+pop+
scale(phen_index1):pop+scale(shoot_h):pop+
scale(veg_h_mean):pop+scale(meanT):pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
summary(model_fruitset_extra_best)
r.squaredLR(model_fruitset_extra_best)
NagelkerkeR2(model_fruitset_extra_best)
?NagelkerkeR2
??NagelkerkeR2
library(fmsb)
NagelkerkeR2(model_fruitset_extra_best)
model_fruitset_extra<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
models_fruitset_extra<-dredge(model_fruitset_extra)
summary(model.avg(models_fruitset_extra,subset=delta<2))
model_fruitset_extra[1]
model_fruitset_extra_best<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+pop+
scale(phen_index1):pop+scale(shoot_h):pop+
scale(veg_h_mean):pop+scale(meanT):pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
summary(model_fruitset_extra_best)
NagelkerkeR2(model_fruitset_extra_best)
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop
,
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data")
clusterEvalQ(clust, library(stats))
models_eggs_extra<-pdredge(model_eggs_extra,cluster=clust)
summary(model.avg(models_eggs_extra, subset = delta < 2)) #Table1
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop
,
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data")
clusterEvalQ(clust, library(pscl))
models_eggs_extra<-pdredge(model_eggs_extra,cluster=clust)
data3
models_eggs_extra<-
dredge(model_eggs_extra,cluster=clust)
models_eggs_extra<-
dredge(model_eggs_extra
)
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data")
clusterEvalQ(clust, library(pscl))
models_eggs_extra<-pdredge(model_eggs_extra,cluster=clust)
model_eggs_extra
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra<-pdredge(model_eggs_extra,cluster=clust)
summary(model.avg(models_eggs_extra, subset = delta < 2)) #Table1
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra<-pdredge(model_eggs_extra,cluster=clust)
summary(model.avg(models_eggs_extra, subset = delta < 2)) #Table1
library(pscl)
library(MuMIn)
library(parallel)
library(fmsb)
model_eggs_extra<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra<-pdredge(model_eggs_extra,cluster=clust)
summary(model.avg(models_eggs_extra, subset = delta < 2)) #Table1
summary(model_phen_best) #R2=0.40
NagelkerkeR2(model_ants_best)
??NagelkerkeR2
