theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,color=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_color_manual(values=c("#FFFF66","#FFFF00","#FFCC33","#FF9900","#FF6600","#FF0000","#CC3333"))
p9
pdf("./results/figures/fig2_phen_height.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
pdf("./results/figures/fig2_phen_height_color.pdf", width=3,height=5)
grid.arrange(p7,p8, ncol=1)
dev.off()
pdf("./results/figures/figS2_ants.pdf", width=4,height=4)
p9
dev.off()
pdf("./results/figures/figS2_ants_color.pdf", width=4,height=4)
p9
dev.off()
#### Model 5: Fruit set ####
#Fruits
data3$fruit_set<-data3$n_intact_fruits/data3$n_fl
# model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
#       scale(veg_h_mean)+scale(meanT)+scale(n_eggs_max))*pop,family="binomial",data=data3,na.action="na.fail")
# summary(model_fruitset)
# models_fruitset<-dredge(model_fruitset)
# summary(model.avg(models_fruitset,subset=delta<2))
#
# model_fruitset_H<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(meanT)+scale(n_eggs_max),
#                       family="binomial",data=subset(data3,pop=="H"),na.action="na.fail")
# model_fruitset_R<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(meanT)+scale(n_eggs_max),
#                       family="binomial",data=subset(data3,pop=="R"),na.action="na.fail")
# model_fruitset_T<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index1)+scale(shoot_h)+scale(veg_h_mean)+scale(meanT)+scale(n_eggs_max),
#                       family="binomial",data=subset(data3,pop=="T"),na.action="na.fail")
# summary(model_fruitset_H)
# summary(model_fruitset_R)
# summary(model_fruitset_T)
##Without Remmene (only 14 plants where fruitset>0)
model_fruitset<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_eggs_max))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
model_fruitset_noT<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_eggs_max))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
model_fruitset_noT_noP<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail")
summary(model_fruitset)
models_fruitset<-dredge(model_fruitset)
models_fruitset_noT<-dredge(model_fruitset_noT)
models_fruitset_noT_noP<-dredge(model_fruitset_noT_noP)
summary(model.avg(models_fruitset,subset=delta<2))
summary(model.avg(models_fruitset_noT,subset=delta<2))
summary(model.avg(models_fruitset_noT_noP,subset=delta<2))
summary(glm(cbind(n_intact_fruits,n_fl)~(scale(meanT))*pop,family="binomial",
data=subset(data3,!pop=="R"),na.action="na.fail"))
print.xtable(xtable(xtable(summary(model.avg(models_fruitset, subset = delta < 2))),
digits=c(0,3,3,3,2,3)), type="html",file="./results/tables/model_fruitset.html")
models_fruitset[1]
model_fruitset_best<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index1)+scale(meanT)+
scale(shoot_h)+scale(n_eggs_max)+pop+pop:scale(meanT)+pop:scale(n_eggs_max),
family="binomial",data=data3)
summary(model_fruitset_best)
r.squaredLR(model_fruitset_best)
NagelkerkeR2(model_fruitset_best)
pdf("./results/figures/fig3_fruitset.pdf", width=3,height=3)
pdf("./results/figures/fig3_fruitset_color.pdf", width=3,height=3)
ggplot(data3, aes(n_eggs_max, fruit_set)) + geom_point(size = 0.5,color="blue")+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl),size=0.5,,color="blue",fill="lightblue")+
theme_base()+xlab("Number of eggs")+ylab("Fruit set")+
theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
dev.off()
#### Model 6: Temp ####
model_temp<-lm(meanT~scale(veg_h_mean)*pop,data=data3,na.action="na.fail")
summary(model_temp)
models_temp<-dredge(model_temp)
summary(model.avg(models_temp, subset = delta < 2))
print.xtable(xtable(xtable(summary(model.avg(models_temp, subset = delta < 2))),
digits=c(0,3,3,3,2,3)), type="html",file="./results/tables/model_temp.html")
models_temp[1]
summary(lm(meanT~veg_h_mean*pop,data=data3,na.action="na.fail"))
model_temp_H<-lm(meanT~scale(veg_h_mean),data=subset(data3,pop=="H")) #*
model_temp_R<-lm(meanT~scale(veg_h_mean),data=subset(data3,pop=="R")) #*
model_temp_T<-lm(meanT~scale(veg_h_mean),data=subset(data3,pop=="T")) #*
summary(model_temp_H)
summary(model_temp_R)
summary(model_temp_T)
print.xtable(xtable(model_temp_H,digits=c(0,3,3,2,3)),type="html",file="./results/tables/model_temp_H.html")
print.xtable(xtable(model_temp_R,digits=c(0,3,3,2,3)),type="html",file="./results/tables/model_temp_R.html")
print.xtable(xtable(model_temp_T,digits=c(0,3,3,2,3)),type="html",file="./results/tables/model_temp_T.html")
#Models for each pop not needed cause no * interaction in averaged model!
pdf("./results/figures/fig_appendix_temp.pdf", width=7,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) + facet_grid(.~population)+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="black")+ylab("Soil temperature")+
geom_point(size = 0.5)+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
pdf("./results/figures/fig_appendix_temp_together.pdf", width=3,height=3)
pdf("./results/figures/fig_appendix_temp_together_color.pdf", width=3,height=3)
ggplot(data3, aes(veg_h_mean,meanT)) +
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.5,color="blue",fill="lightblue")+ylab("Soil temperature")+
geom_point(size = 0.5,color="blue")+ theme_base()+ xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))
dev.off()
p3<-ggplot(data3, aes(veg_h_mean,as.integer(data3$attack),colour=pop)+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="blue",fill = "lightblue")+
geom_point(size = 1,color="blue")+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
p3<-ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# # # # # # # # # #  Final analyses to be included in paper # # # # # # # # #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
library(car)
library(grid)
library(cowplot)
p3<-ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
p3
p3<-ggplot(data3, aes(veg_h_mean,as.integer(data3$attack),colour=pop))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5)+
geom_point(size = 1)+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
p3
with(subset(data3,pop=="T"),range(veg_h_mean))
with(subset(data3,pop=="R"),range(veg_h_mean))
with(subset(data3,pop=="H"),range(veg_h_mean))
47.5-5
52.5-10
60-10
sem1_H<-list(
lm(PC1~veg_h_mean,data=subset(data3,pop=="H")),
glm.nb(n_redants~veg_h_mean,data=subset(data3,pop=="H")),
glm(attack~PC1*(veg_h_mean+n_redants),data=subset(data3,pop=="H"),family="binomial"),#Interactions trait*context NS
glm(cbind(n_intact_fruits,n_fl)~PC1+veg_h_mean+attack,family="binomial",data=subset(data3,pop=="H"))
)
sem.fit(sem1_H,subset(data3,pop=="H"))
sem.coefs(sem1_H,subset(data3,pop=="H"))
sem.model.fits(sem1_H,subset(data3,pop=="H"))
sem1_R<-list(
lm(PC1~veg_h_mean,data=subset(data3,pop=="R")),
glm.nb(n_redants~veg_h_mean,data=subset(data3,pop=="R")),
glm(attack~PC1*(veg_h_mean+n_redants),data=subset(data3,pop=="R"),family="binomial"),#Interactions trait*context NS
glm(cbind(n_intact_fruits,n_fl)~PC1+veg_h_mean+attack,family="binomial",data=subset(data3,pop=="R"))
)
sem.fit(sem1_R,subset(data3,pop=="R"))
sem.coefs(sem1_R,subset(data3,pop=="R")) #attack on fr set NS
sem.model.fits(sem1_R,subset(data3,pop=="R"))
sem1_T<-list(
lm(PC1~veg_h_mean,data=subset(data3,pop=="T")),
glm.nb(n_redants~veg_h_mean,data=subset(data3,pop=="T")),
glm(attack~PC1*(veg_h_mean+n_redants),data=subset(data3,pop=="T"),family="binomial"),#Interactions trait*context NS
glm(cbind(n_intact_fruits,n_fl)~PC1+veg_h_mean+attack,family="binomial",data=subset(data3,pop=="T"))
)
sem.fit(sem1_T,subset(data3,pop=="T"))
sem.coefs(sem1_T,subset(data3,pop=="T")) #veg on ants and on attack NS
ggplot(data3,aes(pop,veg_h_mean))+geom_boxplot(outlier.shape = NA)+theme_base()+xlab("Population")+
ylab("Vegetation height (cm)")+ scale_y_continuous(breaks=c(0,10,20,30,40,50,60))+
theme(plot.background=element_rect(fill="white", colour=NA))+
stat_summary(fun.y=mean, geom="point",size=2)
library(ggplot2)
ggplot(data3,aes(pop,veg_h_mean))+geom_boxplot(outlier.shape = NA)+theme_base()+xlab("Population")+
ylab("Vegetation height (cm)")+ scale_y_continuous(breaks=c(0,10,20,30,40,50,60))+
theme(plot.background=element_rect(fill="white", colour=NA))+
stat_summary(fun.y=mean, geom="point",size=2)
library(ggthemes)
library(gridExtra)
ggplot(data3,aes(pop,veg_h_mean))+geom_boxplot(outlier.shape = NA)+theme_base()+xlab("Population")+
ylab("Vegetation height (cm)")+ scale_y_continuous(breaks=c(0,10,20,30,40,50,60))+
theme(plot.background=element_rect(fill="white", colour=NA))+
stat_summary(fun.y=mean, geom="point",size=2)
with(subset(data3,pop=="H"),summary(veg_h_mean))
with(subset(data3,pop=="H"),mean(veg_h_mean))
with(subset(data3,pop=="H"),stderr(veg_h_mean))
with(subset(data3,pop=="H"),std.error(veg_h_mean))
library(plotrix)
install.packages("plotrix")
library(plotrix)
with(subset(data3,pop=="H"),std.error(veg_h_mean))
with(subset(data3,pop=="R"),mean(veg_h_mean))
with(subset(data3,pop=="R"),std.error(veg_h_mean))
with(subset(data3,pop=="T"),mean(veg_h_mean))
with(subset(data3,pop=="T"),std.error(veg_h_mean))
with(subset(data3,pop=="H"),mean(n_redants))
with(subset(data3,pop=="H"),mean(n_redants))
with(subset(data3,pop=="H"),std.error(n_redants))
with(subset(data3,pop=="R"),mean(n_redants))
with(subset(data3,pop=="R"),std.error(n_redants))
with(subset(data3,pop=="T"),mean(n_redants))
with(subset(data3,pop=="T"),std.error(n_redants))
names(data3)
names(data2)
names(data1)
View(data4)
View(data4)
View(data4A)
View(data5)
View(dataseeds1)
View(dataseeds2)
dataseeds<-read.table("./data/clean/datafile2_seeds.txt",header=T,sep="\t",dec=",")
head(dataseeds)
with(dataseeds,cor(n_intact_fruits,seed_n_per_shoot))
?cor
with(dataseeds,cor(n_intact_fruits,seed_n_per_shoot,na.rm=T))
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,na.rm=T)
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,na.rm=TRUE)
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,use="complete.obs")
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,use="na.or.complete")
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,use="pairwise.complete.obs")
dataseeds$n_intact_fruits
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,use="all.obs")
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,use="everything")
cor(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$seed_n_per_shoot,use="complete.obs")
subset(dataseeds,n_intact_fruits>0)$seed_n_per_shoot
plot(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$seed_n_per_shoot)
head(dataseeds)
cor(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$seed_n_per_shoot,use="complete.obs")
cor(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$seed_n_per_shoot,use="na.or.complete")
cor(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$seed_n_per_shoot,use="pairwise.complete.obs")
head(dataseeds)
cor(dataseeds$n_intact_fruits,dataseeds$total_seed_w_mg_per_shoot,use="complete.obs")
cor(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$total_seed_w_mg_per_shoot,use="complete.obs")
cor(dataseeds$n_intact_fruits,dataseeds$seed_n_per_shoot,use="complete.obs")
cor(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$seed_n_per_shoot,use="complete.obs")
cor(dataseeds$n_intact_fruits,dataseeds$total_seed_w_mg_per_shoot,use="complete.obs")
cor(subset(dataseeds,n_intact_fruits>0)$n_intact_fruits,subset(dataseeds,n_intact_fruits>0)$total_seed_w_mg_per_shoot,use="complete.obs")
head(data3)
library(ggplot2)
library(ggfortify)
library(ggthemes)
theme_set( theme_base( base_family= "Times"))
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="blue",fill = "lightblue")+
geom_point(size = 1,color="blue")+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="blue",fill = "lightblue")+
geom_point(size = 1,color="blue")+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(veg_h_mean,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(meanT,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
library(MASS)
install.packages(c("car", "cowplot", "devtools", "dplyr", "git2r", "Rcpp", "rgdal", "sandwich", "sf", "sp"))
install.packages(c("car", "cowplot", "devtools", "dplyr", "git2r", "Rcpp", "rgdal", "sandwich", "sf", "sp"))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
library(MASS)
library(piecewiseSEM)
library(ggplot2)
library(ggfortify)
library(ggthemes)
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(veg_h_mean,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5)+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,size=0.5)+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,fullrange=T,size=0.5)+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,fullrange=T,size=0.5)+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,fullrange=T,size=0.5,aes(color = population,fill=population))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,fullrange=T,size=0.5,aes(color = population,fill=population))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=0.5,aes(color = population,fill=population))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(subset(data3,n_eggs_max>0), aes(veg_h_mean,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(subset(data3,n_eggs_max>0), aes(veg_h_mean,n_eggs_max))+
geom_smooth(method = "glm.nb", se = T,fullrange=T,size=1,aes(color = population,fill=population))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(subset(data3,n_eggs_max>0), aes(veg_h_mean,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
scale_color_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
scale_fill_manual(values = c("#E58700", "#00BA38", "#E76BF3"))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="blue",fill = "lightblue")+
geom_point(size = 1,color="blue")+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,color="blue",fill = "lightblue")+
geom_point(size = 1,color="blue")+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(subset(data3,n_eggs_max>0), aes(veg_h_mean,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Vegetation height (cm)")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=0.5,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+  theme(legend.position="none")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+  theme(legend.position="none")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+theme(legend.position="none")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+  theme(legend.position="none")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+theme(legend.position="none")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(data3, aes(PC1,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Probability of having eggs")+
xlab("Traits PC1")+  theme(legend.position="none")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(data3, aes(veg_h_mean,as.integer(data3$attack)))+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab(NULL)+theme(axis.text.y = element_blank())+
xlab("Vegetation height (cm)")+theme(legend.position="none")+
theme(plot.background=element_rect(fill="white", colour=NA))
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))+
theme(legend.position="none")
ggplot(subset(data3,n_eggs_max>0), aes(PC1,n_eggs_max))+
geom_smooth(method = "glm.nb", se = F,fullrange=T,size=1,aes(color = population,fill=population))+
geom_point(size = 1,aes(color=population))+theme_base()+ylab("Number of eggs")+
xlab("Traits PC1")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
