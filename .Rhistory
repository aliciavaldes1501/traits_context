geom_point(size = 1)+theme_base()+ylab("Number of eggs")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(data3, aes(meanT,n_redants))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of ants")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(data3, aes(veg_h_mean,n_redants))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of ants")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,pop=="R"), aes(meanT,n_redants))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of ants")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,pop=="T"), aes(meanT,n_redants))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of ants")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(subset(data3,pop=="H"), aes(meanT,n_redants))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of ants")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
ggplot(data3, aes(meanT,n_redants))+
geom_smooth(method = "glm.nb", se = T,aes(linetype = population),size=0.5,color="black")+
geom_point(size = 1)+theme_base()+ylab("Number of ants")+
xlab("Temp")+theme(plot.background=element_rect(fill="white", colour=NA))+
theme(strip.text.x = element_text(colour="white"),strip.background = element_rect(fill="white"))
names(data3)
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+scale(meanT))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants)+
scale(phen_index):scale(meanT)+scale(shoot_h):scale(meanT),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
names(data3)
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+scale(meanT))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants)+
scale(phen_index1):scale(meanT)+scale(shoot_h):scale(meanT),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+scale(meanT))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants)+
scale(phen_index1):scale(meanT)+scale(shoot_h):scale(meanT),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_extra_wT)
n
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
?makeCluster
library(pscl)
library(MuMIn)
library(parallel)
library(fmsb)
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+scale(meanT))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(n_redants)+
scale(phen_index1):scale(meanT)+scale(shoot_h):scale(meanT),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra_wT<-pdredge(model_eggs_extra_wT,cluster=clust)
summary(model.avg(models_eggs_extra_wT, subset = delta < 2))
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+scale(meanT))*pop+
scale(phen_index1):scale(meanT)+scale(shoot_h):scale(meanT),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra_wT<-pdredge(model_eggs_extra_wT,cluster=clust)
library(pscl)
library(MuMIn)
library(parallel)
library(fmsb)
summary(model.avg(models_eggs_extra_wT, subset = delta < 2))
summary(model_eggs_extra_wT)
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+scale(meanT))*pop+
scale(phen_index1):scale(meanT)+scale(shoot_h):scale(meanT),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra_wT<-pdredge(model_eggs_extra_wT,cluster=clust) #REDO - long!
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(meanT)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(meanT)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_extra_wT)
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants)+scale(meanT))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(n_redants)+
scale(phen_index1):scale(meanT)+scale(shoot_h):scale(meanT),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_extra_wT)
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(meanT)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(meanT)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_extra_wT<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(meanT)+scale(phen_index1):scale(n_redants)+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(meanT)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_extra_wT)
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra_wT<-pdredge(model_eggs_extra_wT,cluster=clust)
summary(model.avg(models_eggs_extra_wT, subset = delta < 2))
models_eggs_extra_wT<-pdredge(model_eggs_extra_wT,cluster=clust)
model_eggs_extra_wT1<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(meanT)+scale(phen_index1):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_extra_wT2<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(meanT)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
summary(model_eggs_extra_wT1)
summary(model_eggs_extra_wT2)
model_eggs_extra_wT1<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(meanT)+scale(phen_index1):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_extra_wT2<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(meanT)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra_wT1<-pdredge(model_eggs_extra_wT1,cluster=clust)
library(pscl)
library(MuMIn)
library(parallel)
library(fmsb)
model_eggs_extra_wT1<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(phen_index1):scale(veg_h_mean)+scale(phen_index1):scale(meanT)+scale(phen_index1):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
model_eggs_extra_wT2<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop+
scale(shoot_h):scale(veg_h_mean)+scale(shoot_h):scale(meanT)+scale(shoot_h):scale(n_redants),
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra_wT1<-pdredge(model_eggs_extra_wT1,cluster=clust)
summary(model.avg(models_eggs_extra_wT1, subset = delta < 2))
models_eggs_extra_wT2<-pdredge(model_eggs_extra_wT2,cluster=clust)
summary(model.avg(models_eggs_extra_wT2, subset = delta < 2))
library(pscl)
library(MuMIn)
library(parallel)
library(fmsb)
summary(model.avg(models_eggs_extra_wT1, subset = delta < 2))
summary(model.avg(models_eggs_extra_wT2, subset = delta < 2))
model_eggs_extra_wT3<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(meanT)+scale(n_redants))*pop,
data=data3,dist="negbin",zero.dist="binomial",na.action="na.fail")
models_eggs_extra_wT3<-pdredge(model_eggs_extra_wT3,cluster=clust)
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust, "data3")
clusterEvalQ(clust, library(pscl))
models_eggs_extra_wT3<-pdredge(model_eggs_extra_wT3,cluster=clust)
summary(model.avg(models_eggs_extra_wT3, subset = delta < 2))
2*logLik(models_eggs_extra_wT3)     # Deviance model_eggs
2*logLik(model_eggs_extra_wT3)     # Deviance model_eggs
2*logLik(nullmodel_eggs)  # Deviance null model
(-1459.397-(-1310.878))/-1459.397 # 8.5% !?
summary(model.avg(models_eggs_extra_wT3, subset = delta < 2))
summary(model.avg(models_eggs_extra_wT3, subset = delta < 2))
(-1459.397-(-1310.878))/-1459.397 # 10.2% !?
summary(model.avg(models_eggs_extra_wT1, subset = delta < 2))
(-1459.397-(-1310.878))/-1459.397 # 10.2% !?
summary(model.avg(models_eggs_extra_wT1, subset = delta < 2))
2*logLik(model_eggs_extra_wT1)     # Deviance model_eggs
(-1459.397-(-1302.964))/-1459.397 # 10.2% !?
2*logLik(model_eggs_extra_wT2)     # Deviance model_eggs
(-1459.397-(-1304.385))/-1459.397 # 10.2% !?
l
summary(model.avg(models_eggs_extra_wT2, subset = delta < 2))
summary(model.avg(models_fruitset_extra,subset=delta<2))
summary(model.avg(models_fruitset_extra,subset=delta<2))
NagelkerkeR2(model_fruitset_extra_best)
head(models_eggs_extra_wT3)
models_eggs_extra_wT3[1]
summary(models_eggs_extra_wT3[1])
(-1459.397-(-666.884))/-1459.397 # 10.2% !?
models_eggs_extra_wT3[1]
models_eggs2[1]
(-1459.397-(-517.006))/-1459.397 # 8.5% !?
models_eggs_extra_wT3[1]
2*-666.884     # Deviance model_eggs
(-1459.397-(-1333.768))/-1459.397 # 10.2% !?
(-1459.397-(2*-666.884))/-1459.397 # 10.2% !?
models_eggs_extra_wT1[1] #logLik = -666.884
(-1459.397-(2*-661.643))/-1459.397 # 10.7% !?
models_eggs_extra_wT2[1] #logLik = -661.643
(-1459.397-(2*-666.884))/-1459.397 # 9.3% !?
head(data3)
eggs1_2<-read.table("./data/clean/eggs1_2.txt",header=T,sep="\t",dec=".")
eggs1_2<-read.table("./data/clean/eggs1_2.txt",header=T,sep="\t",dec=".")
head(eggs1_2)
data4
data5
data6
?merge
str(data3)
data6<-merge(data3,eggs1_2)
str(data6)
head(data6)
plot(data6$eggs1)
plot(data6$eggs2)
hist(data6$eggs1)
hist(data6$eggs2)
summary(hurdle(eggs1~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop,
data=data6,dist="negbin",zero.dist="binomial",na.action="na.fail"))
library(pscl)
summary(hurdle(eggs1~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop,
data=data6,dist="negbin",zero.dist="binomial",na.action="na.fail"))
?model1
model1
modelito1
modelito1<-hurdle(eggs1~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop,
data=data6,dist="negbin",zero.dist="binomial",na.action="na.fail")
library(MuMIn)
modelitos1<-dredge(modelito1)
summary(model.avg(modelitos1, subset = delta < 2))
modelito1<-hurdle(n_eggs_max~(scale(phen_index1)+scale(shoot_h)+
scale(veg_h_mean)+scale(n_redants))*pop,
data=data6,dist="negbin",zero.dist="binomial",na.action="na.fail")
modelitos1<-dredge(modelito1)
summary(model.avg(modelitos1, subset = delta < 2))
with(data6,plot(n_redants,eggs1))
with(data6,plot(n_redants,eggs2))
rm(data6)
rm(modelito1)
rm(modelitos1)
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) + facet_grid(.~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
library(ggplot2)
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) + facet_grid(.~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
library(ggthemes)
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) + facet_grid(.~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) + facet_grid(.~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
fig2ab<-plot_grid(p7,p8,ncol=1,align="v", rel_heights = c(1, 1.1))
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
library(ggthemr)
library(xtable)
library(ggthemes)
library(fmsb)
library(gridExtra)
library(car)
library(grid)
library(cowplot)
p7<-ggplot(data3, aes(meanT,phen_index1))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,color="black")+ylab(NULL)+
geom_point(size = 0.5)+ theme_base()+ xlab(NULL)+ylab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_x_continuous(limits = c(14,19))
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,color="black",
aes(linetype = population))+ylab(NULL)+
geom_point(size = 0.5)+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_linetype_manual(values = c("solid", "dashed", "dotted"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) + facet_grid(.~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
fig2ab<-plot_grid(p7,p8,ncol=1,align="v", rel_heights = c(1, 1.1))
plot_grid(fig2ab, NULL, p9, ncol = 3, rel_heights = c(1,1,1), align="v",rel_widths=c(6,0.07,8))
p7
p8
dev.off()
data3$fruit_set<-data3$n_intact_fruits/data3$n_fl
dev.off()
dev.off()
p7
fig2ab<-plot_grid(p7,p8,ncol=2,align="v", rel_heights = c(1, 1.1))
fig2ab
p7<-ggplot(data3, aes(meanT,phen_index1))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,color="black")+ylab(NULL)+
geom_point(size = 0.5)+ theme_base()+ xlab("Soil temperature")+ylab("Plant phenology")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_x_continuous(limits = c(14,19))
p8<-ggplot(data3, aes(meanT,shoot_h))+
geom_smooth(method = "lm",  se = T,fullrange=T,size=0.4,color="black",
aes(linetype = population))+ylab(NULL)+
geom_point(size = 0.5)+ theme_base()+ xlab("Soil temperature")+ylab("Shoot height (cm)")+
theme(plot.background=element_rect(fill="white", colour=NA))+
scale_linetype_manual(values = c("solid", "dashed", "dotted"))+
theme(legend.position="none")+scale_x_continuous(limits = c(14,19))
plot_grid(p7,p8,ncol=2,align="v", rel_heights = c(1, 1.1))
plot_grid(p7,p8,ncol=2,align="v")
a<-plot_grid(p7,p8,ncol=2,align="v")
a
dev.off()
dev.off()
a
dev.off()
plot_grid(p7,p8,ncol=2,align="v")
pdf("./results/figures/fig2_phen_height.pdf", family="Times",width=8,height=5)
plot_grid(p7,p8,ncol=2,align="v")
dev.off()
dev.off()
dev.off()
p7_8<-plot_grid(p7,p8,ncol=2,align="v")
p7_8
dev.off()
dev.off()
pdf("./results/figures/fig2_phen_height.pdf", family="Times",width=8,height=5)
p7_8
dev.off()
?plot_grid
pdf("./results/figures/fig2_phen_height.pdf", family="Times",width=8,height=4)
p7_8
dev.off()
dev.off()
pdf("./results/figures/fig2_phen_height.pdf", family="Times",width=8,height=4)
p7_8
dev.off()
pdf("./results/figures/fig2_phen_height.pdf", family="Times",width=6,height=3)
p7_8
dev.off()
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT))) + facet_grid(.~population)+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
p9<-ggplot(int_ants, aes(veg_h_mean,fit, group = as.factor(meanT)))+
geom_line(size=0.6,aes(veg_h_mean,fit,linetype=as.factor(meanT)))+theme_base()+xlab("Vegetation height (cm)")+
ylab(expression(paste("Number of ", italic("Myrmica")," ants")))+
coord_cartesian(xlim=c(0,72),ylim=c(0,40))+theme(legend.position="none")+
annotate("text", x = 66.5, y = 28.3, label = "20 ºC")+
annotate("text", x = 66.5, y = 19.3, label = "19 ºC")+
annotate("text", x = 66.5, y = 13, label = "18 ºC")+
annotate("text", x = 66.5, y = 9, label = "17 ºC")+
annotate("text", x = 66.5, y = 6.3, label = "16 ºC")+
annotate("text", x = 66.5, y = 4.4, label = "15 ºC")+
annotate("text", x = 66.5, y = 2.6, label = "14 ºC")+
theme(plot.background=element_rect(fill="white", colour=NA))
p9
pdf("./results/figures/figS2_ants.pdf", family="Times",width=3,height=3)
p9
dev.off()
pdf("./results/figures/figS2_ants.pdf", family="Times",width=4,height=3)
p9
dev.off()
pdf("./results/figures/figS2_ants.pdf", family="Times",width=4,height=4)
p9
dev.off()
data1comp<-data1[complete.cases(data1[37:54]),]
sem.fit(fruits.modList, data1comp,
corr.errors = c("most_adv~~n_fl_corrected","shoot_h~~n_fl_corrected","most_adv~~shoot_h"))
library(piecewiseSEM)
library(MASS)
sem.fit(fruits.modList, data1comp,
corr.errors = c("most_adv~~n_fl_corrected","shoot_h~~n_fl_corrected","most_adv~~shoot_h"))
head(data1)
data1comp<-data1[complete.cases(data1[37:54]),]
fruits.modList<-list(
#Predicting number of intact fruits
glm(n_intact_fruits~most_adv+shoot_h+n_fl_corrected+avg_d_min_ja+n_eggs_max+population,family="poisson",na.action="na.fail",data=data1comp),
#Predicting number of eggs
glm.nb(n_eggs_max~most_adv+n_fl_corrected+shoot_h+avg_d_min_ja+veg_h_mean+n_redants+population,na.action="na.fail",data=data1comp),
#Predicting number of ants
glm.nb(n_redants~veg_h_mean+population,na.action="na.fail",data=data1comp)
)
fruits.modList<-list(
#Predicting number of intact fruits
glm(n_intact_fruits~most_adv+shoot_h+n_fl_corrected+avg_d_min_ja+n_eggs_max+population,family="poisson",na.action="na.fail",data=data3),
#Predicting number of eggs
glm.nb(n_eggs_max~most_adv+n_fl_corrected+shoot_h+avg_d_min_ja+veg_h_mean+n_redants+population,na.action="na.fail",data=data3),
#Predicting number of ants
glm.nb(n_redants~veg_h_mean+population,na.action="na.fail",data=data3)
)
head(data3)
fruits.modList<-list(
#Predicting number of intact fruits
glm(n_intact_fruits~most_adv+shoot_h+n_fl_corrected+avg_d_min_ja+n_eggs_max+population,family="poisson",na.action="na.fail",data=data3),
#Predicting number of eggs
glm.nb(n_eggs_max~most_adv+n_fl_corrected+shoot_h+avg_d_min_ja+veg_h_mean+n_redants+population,na.action="na.fail",data=data3),
#Predicting number of ants
glm.nb(n_redants~veg_h_mean+population,na.action="na.fail",data=data3)
)
fruits.modList<-list(
#Predicting number of intact fruits
glm(n_intact_fruits~most_adv1+shoot_h+n_fl_corrected+avg_d_min_ja+n_eggs_max+population,family="poisson",na.action="na.fail",data=data3),
#Predicting number of eggs
glm.nb(n_eggs_max~most_adv1+n_fl_corrected+shoot_h+avg_d_min_ja+veg_h_mean+n_redants+population,na.action="na.fail",data=data3),
#Predicting number of ants
glm.nb(n_redants~veg_h_mean+population,na.action="na.fail",data=data3)
)
fruits.modList<-list(
#Predicting number of intact fruits
glm(n_intact_fruits~most_adv1+shoot_h+n_fl+n_eggs_max+population,family="poisson",na.action="na.fail",data=data3),
#Predicting number of eggs
glm.nb(n_eggs_max~most_adv1+n_fl+shoot_h+veg_h_mean+n_redants+population,na.action="na.fail",data=data3),
#Predicting number of ants
glm.nb(n_redants~veg_h_mean+population,na.action="na.fail",data=data3)
)
sem.fit(fruits.modList, data3,
corr.errors = c("most_adv1~~n_fl","shoot_h~~n_fl","most_adv1~~shoot_h"))
sem.model.fits(fruits.modList)
sem.coefs(fruits.modList, data3,
corr.errors = c("most_adv1~~n_fl","shoot_h~~n_fl","most_adv1~~shoot_h"))
library(lme4)
c
fruits.modList<-list(
#Predicting number of intact fruits
glmer(n_intact_fruits~most_adv1+shoot_h+n_fl+n_eggs_max+(1|population),family="poisson",na.action="na.fail",data=data3),
#Predicting number of eggs
glmer.nb(n_eggs_max~most_adv1+n_fl+shoot_h+veg_h_mean+n_redants+(1|population),na.action="na.fail",data=data3),
#Predicting number of ants
glmer.nb(n_redants~veg_h_mean+(1|population),na.action="na.fail",data=data3)
)
