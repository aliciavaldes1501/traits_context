lrtest(m3,m4)
library(lmtest)
lrtest(m3,m4)
rm(ms3)
m3<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*pop,
data=data8,dist="negbin",zero.dist="binomial",na.action="na.fail")
m4<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants))*pop,
data=data8,dist="poisson",zero.dist="binomial",na.action="na.fail")
AIC(m3,m4)
vuong(m3,m4)
pchisq(2 * (logLik(m1) - logLik(mnull)), df = 2, lower.tail = FALSE) #Model is significant
pchisq(2 * (logLik(m1) - logLik(mnull)), df = 2, lower.tail = FALSE) #Model is significant
m1<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=data8,dist="negbin",zero.dist="binomial",na.action="na.fail")
m2<-glm.nb(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=data8,na.action="na.fail")
m1<-hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=data8,dist="negbin",zero.dist="binomial",na.action="na.fail")
m2<-glm.nb(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=data8,na.action="na.fail")
AIC(m1,m2) #hurdle is better
vuong(m1,m2) #hurdle is better
modelattack<-glm(attack~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=data8,family="binomial")
summary(modelattack)
modeleggs<-glm(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data8,n_eggs_max>0),family="poisson")
summary(modeleggs) # Strongly overdispersed! - Reason for * effect of ants?
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data8,n_eggs_max>0))
summary(modeleggs) # Definitely better but no effect of ants
modeleggs<-glm(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data8,n_eggs_max>0),family="poisson")
summary(modeleggs) # Strongly overdispersed! - Reason for * effect of ants?
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data8,n_eggs_max>0))
summary(modeleggs) # Definitely better but no effect of ants
summary(hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=subset(data8,pop=="H"),
dist="negbin",zero.dist="binomial",na.action="na.fail"))
summary(hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=subset(data8,pop=="R"),
dist="negbin",zero.dist="binomial",na.action="na.fail"))
summary(hurdle(n_eggs_max~scale(phen_index_avg)+scale(over_veg),data=subset(data8,pop=="T"),
dist="negbin",zero.dist="binomial",na.action="na.fail"))
ggplot(subset(data8,n_eggs_max>0), aes(phen_index_avg,n_eggs_max,colour=pop)) +
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)
ggplot(subset(data8,n_eggs_max>0), aes(phen_index_avg,n_eggs_max)) +
geom_smooth(method = "glm.nb", se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(subset(data8,n_eggs_max>0), aes(phen_index_avg,n_eggs_max)) +
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)
ggplot(subset(data8,n_eggs_max>0), aes(n_redants,n_eggs_max,colour=pop)) +
geom_smooth(method = "glm.nb", se = T)+
geom_point(size = 1)
ggplot(subset(data8,n_eggs_max>0), aes(n_redants,n_eggs_max)) +
geom_smooth(method = "glm.nb", se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(data8, aes(over_veg,ifelse(as.integer(data8$attack)==2,1,0),colour=pop)) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)
ggplot(data8, aes(over_veg,ifelse(as.integer(data8$attack)==2,1,0))) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(data8, aes(over_veg,ifelse(as.integer(data8$attack)==2,1,0))) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = T)+
geom_point(size = 1)
head(n_redants_mean)
str(n_redants_mean)
with(data9,plot(n_eggs_max))
with(data9,hist(n_eggs_max))
with(subset(data9,n_eggs_max>0),hist(n_eggs_max))
with(data9,hist(n_eggs_max,breaks=40))
with(subset(data9,n_eggs_max>0),hist(n_eggs_max,breaks=40))
with(data9,hist(n_eggs_max,breaks=40,main="Number of eggs"))
with(subset(data9,n_eggs_max>0),hist(n_eggs_max,breaks=40,main="Number of eggs when >0"))
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data9,n_eggs_max>0))
summary(modeleggs)
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants_mean)+pop+scale(n_redants_mean):pop,data=subset(data9,n_eggs_max>0))
summary(modeleggs)
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants_mean)+pop,data=subset(data9,n_eggs_max>0))
summary(modeleggs)
summary(model.avg(modelsF, subset = delta < 2))
summary(model.avg(modelsF, subset = delta < 2))
summary(model.avg(modelsF, subset = delta < 2))
data9$redants_presC
summary(model.avg(modelsG, subset = delta < 2))
modelG<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+redants_presC)*pop,
data=data9,dist="negbin",zero.dist="binomial",na.action="na.fail")
modelsG<-dredge(modelG)
summary(model.avg(modelsG, subset = delta < 2))
modelsG[1]
n_redants_sum<-read.table("n_redants_sum.txt",header=T,sep=",",dec=".")
n_redants_sum<-read.table("n_redants_sum.txt",header=T,sep=",",dec=".")
n_redants_sum<-read.table("n_redants_sum.txt",header=T,sep=",",dec=".")
head(n_redants_sum)
str(n_redants_sum)
data10<-merge(data9,n_redants_sum,by="id_pl")
head(data10)
with(data10,hist(n_redants_sum))
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data10,n_eggs_max>0))
summary(modeleggs)
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants_mean)+pop+scale(n_redants_sum):pop,data=subset(data10,n_eggs_max>0))
summary(modeleggs)
str(data10)
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data10,n_eggs_max>0))
summary(modeleggs)
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants_sum)+pop+scale(n_redants_sum):pop,data=subset(data10,n_eggs_max>0))
summary(modeleggs)
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants_mean)+pop+scale(n_redants_mean):pop,data=subset(data10,n_eggs_max>0))
summary(modeleggs)
with(data10,plot(n_redants_mean,n_redants_sum))
with(data10,cor(n_redants_mean,n_redants_sum))
data10$n_redants_mean
data10$n_redants_sum
n_redants_sum<-read.table("n_redants_sum.txt",header=T,sep=",",dec=".")
head(n_redants_sum)
str(n_redants_sum)
data10<-merge(data9,n_redants_sum,by="id_pl")
head(data10)
with(data10,hist(n_redants_sum))
with(data10,cor(n_redants_mean,n_redants_sum))
with(data10,plot(n_redants_mean,n_redants_sum))
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants)+pop+scale(n_redants):pop,data=subset(data10,n_eggs_max>0))
summary(modeleggs)
modeleggs<-glm.nb(n_eggs_max~scale(over_veg)+scale(phen_index_avg)+scale(n_redants_sum)+pop+scale(n_redants_sum):pop,data=subset(data10,n_eggs_max>0))
summary(modeleggs)
modelH<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants_sum))*pop,
data=data9,dist="negbin",zero.dist="binomial",na.action="na.fail")
modelsH<-dredge(modelH)
modelH<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants_sum))*pop,
data=data10,dist="negbin",zero.dist="binomial",na.action="na.fail")
modelsH<-dredge(modelH)
summary(model.avg(modelsH, subset = delta < 2))
with(data10,hist(n_redants_sum))
with(data10,hist(log(n_redants_sum)))
with(data10,hist(log(n_redants_sum+1)))
with(data10,hist(log(n_redants_sum+0.5)))
modelH<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(log(n_redants_sum+1)))*pop,
data=data10,dist="negbin",zero.dist="binomial",na.action="na.fail")
modelsH<-dredge(modelH)
summary(model.avg(modelsH, subset = delta < 2))
modelsH
modelsH[â™£1]
modelsH[1]
modelH<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants_sum))*pop,
data=data10,dist="negbin",zero.dist="binomial",na.action="na.fail")
modelsH<-dredge(modelH)
summary(model.avg(modelsH, subset = delta < 2))
data10$n_redants_sumC<-ifelse(data10$days_ant_pres==1,0,data10$n_redants_sum)
modelI<-hurdle(n_eggs_max~(scale(phen_index_avg)+scale(over_veg)+scale(n_redants_sumC))*pop,
data=data10,dist="negbin",zero.dist="binomial",na.action="na.fail")
modelsI<-dredge(modelI)
summary(model.avg(modelsI, subset = delta < 2))
with(data10,hist(n_intact_fruits))
with(subset(data10,n_intact_fruits>0),hist(n_intact_fruits))
modelfr1<-glm(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean))*pop)
modelfr1<-glm(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean))*pop,
family="poisson",data10)
summary(modelfr1)
modelfr1<-glm(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,family="poisson",data10)
summary(modelfr1)
modelfr2<-glm.nb(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,data10)
summary(modelfr2)
AIC(modelfr1,modelfr2)
vuong(modelfr1,modelfr2)
modelfr3<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="poisson",zero.dist="binomial",data10)
modelfr4<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="negbin",zero.dist="binomial",data10)
AIC(modelfr1,modelfr2,modelfr3,modelfr4) #Only slightly lower for nb
modelfr3<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="poisson",zero.dist="binomial",data10)
modelfr4<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="negbin",zero.dist="binomial",data10)
AIC(modelfr1,modelfr2,modelfr3,modelfr4) #Only slightly lower for nb
vuong(modelfr1,modelfr2,modelfr3)
vuong(modelfr1,modelfr3)
vuong(modelfr2,modelfr4)
summary(modelfr3)
summary(modelfr4)
AIC(modelfr1,modelfr2,modelfr3,modelfr4) #Still nb
modelsfr1<-dredge(modelfr1)
modelfr1<-glm(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,family="poisson",data10,na.action="na.fail")
modelsfr1<-dredge(modelfr1)
modelfr2<-glm.nb(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,data10,na.action="na.fail")
modelfr3<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="poisson",zero.dist="binomial",data10,na.action="na.fail")
modelfr4<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="negbin",zero.dist="binomial",data10,na.action="na.fail")
summary(model.avg(modelsfr1,subset=delta<2))
modelfr1<-glm(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,family="poisson",data10,na.action="na.fail")
summary(modelfr1)
modelsfr1<-dredge(modelfr1)
summary(model.avg(modelsfr1,subset=delta<2))
modelfr1<-glm(n_intact_fruits~(scale(phen_index_avg)+scale(n_eggs_max))*
pop,family="poisson",data10,na.action="na.fail")
modelsfr1<-dredge(modelfr1)
summary(model.avg(modelsfr1,subset=delta<2))
modelfr1<-glm(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,family="poisson",data10,na.action="na.fail")
modelsfr1<-dredge(modelfr1)
summary(model.avg(modelsfr1,subset=delta<2))
modelsfr1[1]
summary(glm(n_intact_fruits~scale(meanT)+scale(n_eggs_max)+scale(phen_index_avg)+pop+pop:scale(meanT)+pop:scale(phen_index_avg),
family="poisson",data10))
summary(model.avg(modelsfr1,subset=delta<2))
modelsfr2<-dredge(modelfr2)
summary(model.avg(modelsfr2,subset=delta<2))
modelfr2<-glm.nb(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,data10,na.action="na.fail")
modelsfr2<-dredge(modelfr2)
summary(model.avg(modelsfr2,subset=delta<2))
modelfr3<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="poisson",zero.dist="binomial",data10,na.action="na.fail")
modelsfr3<-dredge(modelfr3)
summary(model.avg(modelsfr3,subset=delta<2))
modelfr3<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dist="poisson",zero.dist="binomial",data10,na.action="na.fail")
modelsfr3<-dredge(modelfr3)
summary(model.avg(modelsfr3,subset=delta<2))
modelfr4<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(veg_h_mean)+scale(n_eggs_max))*
pop,dist="negbin",zero.dist="binomial",data10,na.action="na.fail")
modelsfr4<-dredge(modelfr4)
summary(model.avg(modelsfr4,subset=delta<2))
modelfr4<-hurdle(n_intact_fruits~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dist="negbin",zero.dist="binomial",data10,na.action="na.fail")
modelsfr4<-dredge(modelfr4)
summary(model.avg(modelsfr4,subset=delta<2))
with(data10,summary(glm(n_intact_fruits~phen_index_avg,family="poisson",data10))
)
with(data10,summary(glm.nb(n_intact_fruits~phen_index_avg,data10)))
with(data10,summary(glm(n_intact_fruits~n_eggs_max,family="poisson",data10)))
summary(model.avg(modelsfr2,subset=delta<2))
with(data10,summary(glm.nb(n_intact_fruits~n_eggs_max,data10)))
with(data10,summary(glm.nb(n_intact_fruits~meanT,data10)))
AIC(modelfr1,modelfr2,modelfr3,modelfr4) #Still nb
summary(model.avg(modelsfr4,subset=delta<2))
AIC(modelfr1,modelfr2) #Only slightly lower for nb
vuong(modelfr1,modelfr2) #Indistinguishible
vuong(modelfr1,modelfr3)
vuong(modelfr2,modelfr4)
summary(model.avg(modelsfr1,subset=delta<2))
modelsfr[1]
modelsfr1[1]
summary(glm(n_intact_fruits~pop+scale(meanT)+scale(n_eggs_max)+scale(phen_index_avg)+
+pop:scale(meanT)+pop:scale(phen_index_avg),family="poisson",data10)
)
ggplot(data10, aes(phen_index_avg,n_intact_fruits,colour=pop)) +
geom_smooth(method = "glm", method.args=list(family="poisson"),se = T)+
geom_point(size = 1)
ggplot(data10, aes(phen_index_avg,n_eggs_max)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+facet_grid(.~pop)+
geom_point(size = 1)
summary(model.avg(modelsfr1,subset=delta<2))
ggplot(data10, aes(phen_index_avg,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(data10, aes(phen_index_avg,n_intact_fruits,colour=pop)) +
geom_smooth(method = "glm", method.args=list(family="poisson"),se = T)+
geom_point(size = 1)
ggplot(data10, aes(phen_index_avg,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(data10, aes(phen_index_avg,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,n_intact_fruits,colour=pop)) +
geom_smooth(method = "glm", method.args=list(family="poisson"),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+
geom_point(size = 1)
summary(model.avg(modelsfr1,subset=delta<2))
summary(modelfr1)
head(data1comp)
summary(model.avg(modelsfr1,subset=delta<2))
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
data2comp[55]
data2comp<-data2[complete.cases(data2[37:54]),]
data2<-read.table("datafile1_seeds.txt",header=T,sep="\t",dec=",")
head(data2)
tail(data2)
str(data2)
data2$attack<-as.factor(with(data2,ifelse(n_eggs_max>0,"1","0")))
head(data2)
tail(data2)
summary(data2)
names(data2)
data2comp<-data2[complete.cases(data2[37:54]),]
data2comp<-subset(data2comp,seed_n_per_shoot<10000) #Removed 1 outlier from Tanga with 15 fruits!
data2compA<-data2comp[complete.cases(data2comp[55]),]
data2comp[55]
head(data2comp[56])
head(data2compA)
str(data2compA)
names(data2compA)
head(data2compA[c(2,55)])
dataseeds<-merge(data10,data2compA[c(2,55)],by="id_pl")
head(dataseeds)
names(dataseeds)
str(dataseeds)
with(dataseeds(table(pop)))
with(dataseeds,table(pop))
with(dataseeds,hist(seed_n_per_shoot))
with(subset(dataseeds,seed_n_per_shoot>0),hist(seed_n_per_shoot))
modelseeds1<-glm(seed_n_per_shoot~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,family="poisson",data10,na.action="na.fail")
modelseeds1<-glm(seed_n_per_shoot~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,family="poisson",dataseeds,na.action="na.fail")
dataseeds$seed_n_per_shoot
round(dataseeds$seed_n_per_shoot)
modelseeds1<-glm(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,family="poisson",dataseeds,na.action="na.fail")
summary(modelseeds1)
modelseeds2<-glm.nb(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dataseeds,na.action="na.fail")
warnings()
summary(modelseeds2)
modelseeds3<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dist="poisson",zerodist="binomial",dataseeds,na.action="na.fail")
modelseeds3<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dist="poisson",zero.dist="binomial",dataseeds,na.action="na.fail")
?zeroinfl
modelseeds3<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dist="poisson",dataseeds,na.action="na.fail")
summary(modelseeds3)
modelseeds4<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dist="negbin",dataseeds,na.action="na.fail")
summary(modelseeds4)
AIC(modelseeds3,modelseeds4)
modelsseeds4<-dredge(modelseeds4)
summary(model.avg(modelsseeds4,subset=delta<2))
modelsseeds4[1]
summary(zeroinfl(round(seed_n_per_shoot)~scale(phen_index_avg)+scale(n_eggs_max)+
pop+pop:scale(phen_index_avg),dist="negbin",dataseeds,na.action="na.fail"))
modelseeds4<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max)+
scale(n_fruits_max))*
pop,dist="negbin",dataseeds,na.action="na.fail")
modelseeds4<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max)+
scale(n_intact_fruits))*
pop,dist="negbin",dataseeds,na.action="na.fail")
modelseeds4<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max)+
scale(n_intact_fruits))*
pop,dist="negbin",dataseeds,na.action="na.fail")
summary(modelseeds4)
AIC(modelseeds3,modelseeds4) # Go for negbin
modelsseeds4<-dredge(modelseeds4)
summary(model.avg(modelsseeds4,subset=delta<2))
modelseeds4<-zeroinfl(round(seed_n_per_shoot)~(scale(phen_index_avg)+scale(meanT)+scale(n_eggs_max))*
pop,dist="negbin",dataseeds,na.action="na.fail")
summary(modelseeds4)
modelsseeds4<-dredge(modelseeds4)
with(data10,hist(n_intact_fruits))
with(subset(data10,n_intact_fruits>0),hist(n_intact_fruits))
with(data10,hist(n_intact_fruits,breaks=15))
with(subset(data10,n_intact_fruits>0),hist(n_intact_fruits,breaks=15))
with(data10,hist(n_intact_fruits,breaks=15, main = "Number of intact fruits"))
with(subset(data10,n_intact_fruits>0),hist(n_intact_fruits,breaks=15, main = "Number of intact fruits > 0"))
with(data10,hist(n_intact_fruits,breaks=15, main = "Number of intact fruits"))
with(subset(data10,n_intact_fruits>0),hist(n_intact_fruits,breaks=15, main = "Number of intact fruits > 0"))
with(subset(data10,n_intact_fruits>0),mean(n_intact_fruits))
with(subset(data10,n_intact_fruits>0),var(n_intact_fruits))
with(data10,mean(n_intact_fruits))
with(data10,var(n_intact_fruits))
summary(model.avg(modelsfr1,subset=delta<2))
summary(model.avg(modelsfr1,subset=delta<2))
summary(model.avg(modelsfr1,subset=delta<2))
ggplot(data10, aes(phen_index_avg,n_intact_fruits,colour=pop)) +
geom_smooth(method = "glm", method.args=list(family="poisson"),se = T)+
geom_point(size = 1)
ggplot(data10, aes(phen_index_avg,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(data10, aes(phen_index_avg,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,n_intact_fruits,colour=pop)) +
geom_smooth(method = "glm", method.args=list(family="poisson"),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+facet_grid(.~pop)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,n_intact_fruits)) +
geom_smooth(method = "glm", method.args=list(family="poisson"), se = T)+
geom_point(size = 1)
names(data10)
data10$fruit_set<-data10$n_intact_fruits/data10$n_fl
with(data10,boxplot(fruit_set))
with(data10,min(fruit_set))
with(data10,mean(fruit_set))
with(data10,max(fruit_set))
with(data10,hist(fruit_set))
with(data10,plot(fruit_set))
with(data10,plot(pop,fruit_set))
model_fs<-glm(cbind(n_intact_fruits,n_fl)~scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(veg_h_mean),
family="binomial",data10,na.action="na.fail")
summary(model_fs)
model_fs<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(veg_h_mean))*pop,
family="binomial",data10,na.action="na.fail")
summary(model_fs)
models_fs<-dredge(model_fs)
summary(model.avg(models_fs,subset=delta<2))
plot(model_fs)
summary(model.avg(models_fs,subset=delta<2))
model_fs<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT))*pop,
family="binomial",data10,na.action="na.fail")
summary(model_fs)
models_fs<-dredge(model_fs)
summary(model.avg(models_fs,subset=delta<2))
ggplot(data10, aes(n_eggs_max,fruit_set,colour=pop)) +
geom_smooth(method = "glm", method.args=list(family="binomial"),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", method.args=list(family="binomial"),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", family=binomial,, aes(weight = n_fl),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,fruit_set,colour=pop)) +
geom_smooth(method = "glm", family=binomial,, aes(weight = n_fl),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max, fruit_set)) +
geom_point() + geom_smooth(method = "glm", family = binomial, aes(weight = n_fl))
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", method.args=list(family=binomial,aes(weight = trials)),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", method.args=list(family=binomial,weight = trials)),se = T)+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", method.args=list(family=binomial,weight = trials))+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", method.args=list(family=binomial,weight = n_fl))+
geom_point(size = 1)
names(data10)
ggplot(data10, aes(n_eggs_max, fruit_set)) +
geom_point() + geom_smooth(method = "glm", family = binomial, aes(weight = data10$n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) +
geom_point() + geom_smooth(method = "glm", family = "binomial", aes(weight = data10$n_fl))
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", method.args=list(family=binomial,weight = n_fl))+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max,cbind(n_intact_fruits,n_fl),colour=pop)) +
geom_smooth(method = "glm", method.args=list(family=binomial,weight = data10$n_fl))+
geom_point(size = 1)
ggplot(data10, aes(n_eggs_max, fruit_set)) +
geom_point() +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight = data10$n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) +
geom_point() +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight = n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) +
geom_point(size = 1)) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) +
geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set,colour=pop)) +
geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(phen_index_avg, fruit_set,colour=pop)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
with(data10,hist(fruit_set))
model_fs<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(veg_h_mean))*pop,
family="binomial",data10,na.action="na.fail")
summary(model_fs)
models_fs<-dredge(model_fs)
summary(model.avg(models_fs,subset=delta<2)) # Phen, eggs and pop *, no interactions
summary(model.avg(models_fs,subset=delta<2)) # Phen, eggs and pop *, no interactions
model_fs<-glm(cbind(n_intact_fruits,n_fl)~(scale(phen_index_avg)+scale(n_eggs_max)+scale(meanT)+scale(over_veg))*pop,
family="binomial",data10,na.action="na.fail")
summary(model_fs)
models_fs<-dredge(model_fs)
summary(model.avg(models_fs,subset=delta<2)) # Phen, eggs and pop *, no interactions
ggplot(data10, aes(n_eggs_max, fruit_set,colour=pop)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(n_eggs_max, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(phen_index_avg, fruit_set,colour=pop)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) + facet_grid(.~pop)+
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
ggplot(data10, aes(phen_index_avg, fruit_set)) + geom_point(size = 1) +
geom_smooth(method = "glm", method.args=list(family = "binomial"), aes(weight=n_fl))
library(ggplot2)
library(MASS)
library(MuMIn)
library(visreg)
library(effects)
library(pscl)
library(lme4)
summary(model.avg(modelsDbis, subset = delta < 2))
summary(model.avg(modelsDbisbis, subset = delta < 2))
summary(model.avg(modelsDbisbisbis, subset = delta < 2))
summary(model.avg(modelsBbis, subset = delta < 2))
